
:root{
  --bg:#eef1f5;
  --card:#ffffff;
  --text:#111827;
  --sub:#1e3a8a; /* dark blue secondary */
  --muted:#6b7280;
  --shadow: 0 14px 40px rgba(0,0,0,.12);
  --shadow2: 0 10px 24px rgba(0,0,0,.10);
  --radius:18px;
  --radius2:14px;
  --accent:#2563eb;
}

@media (prefers-color-scheme: dark){
  :root{
    --bg:#0b1020;
    --card:#121a2f;
    --text:#eef2ff;
    --sub:#93c5fd;
    --muted:#94a3b8;
    --shadow: 0 18px 55px rgba(0,0,0,.45);
    --shadow2: 0 12px 32px rgba(0,0,0,.35);
    --accent:#60a5fa;
  }
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  color:var(--text);
  background:
    radial-gradient(1200px 700px at 15% 10%, rgba(37,99,235,.10), transparent 60%),
    radial-gradient(900px 700px at 85% 20%, rgba(16,185,129,.10), transparent 60%),
    radial-gradient(1000px 800px at 50% 95%, rgba(245,158,11,.10), transparent 60%),
    var(--bg);
}

.app{max-width:980px;margin:0 auto;min-height:100%;padding:14px 14px 96px}
.topbar{
  position:sticky;top:0;z-index:10;
  display:flex;align-items:center;justify-content:space-between;
  padding:10px 4px 14px;
  backdrop-filter: blur(10px);
}
.brand{display:flex;gap:10px;align-items:center}
.logo{
  width:42px;height:42px;border-radius:14px;
  display:grid;place-items:center;
  background:rgba(255,255,255,.75);
  border:1px solid rgba(0,0,0,.06);
  box-shadow: var(--shadow2);
  font-weight:800;
}
.brandTitle{font-weight:800}
.brandSub{font-size:12px;color:var(--muted)}
.btn{
  border:1px solid rgba(0,0,0,.08);
  background:rgba(255,255,255,.85);
  color:var(--text);
  padding:10px 12px;
  border-radius:14px;
  box-shadow: var(--shadow2);
  cursor:pointer;
}
.btn.ghost{background:rgba(255,255,255,.55)}
.btn.primary{background:var(--accent);color:white;border-color:transparent}
.btn:active{transform:translateY(1px)}
.view{padding:8px 2px}
.card{
  background:var(--card);
  border-radius:var(--radius);
  box-shadow: var(--shadow);
  border:1px solid rgba(0,0,0,.06);
}
.section{padding:16px;margin:12px 0}
.h1{font-size:22px;font-weight:900;margin:0 0 6px}
.sub{color:var(--sub);font-weight:700;font-size:13px}
.row{display:flex;gap:12px;flex-wrap:wrap}
.kpi{flex:1;min-width:200px;padding:14px;border-radius:var(--radius2);background:rgba(0,0,0,.03)}
.kpi .v{font-size:22px;font-weight:900}
.kpi .l{font-size:12px;color:var(--sub);font-weight:700}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width:740px){.grid2{grid-template-columns:1fr}}

.bottomnav{
  position:fixed;left:50%;transform:translateX(-50%);
  bottom:14px;z-index:20;
  width:min(520px, calc(100% - 28px));
  display:grid;grid-template-columns:repeat(6,1fr);
  gap:8px;
  padding:10px;
  border-radius:22px;
  background:rgba(255,255,255,.78);
  backdrop-filter: blur(14px);
  box-shadow: var(--shadow);
  border:1px solid rgba(0,0,0,.06);
}

@media (max-width:420px){
  .bottomnav{gap:6px;padding:8px;}
  .tab{padding:7px 4px;border-radius:14px;}
  .tab span:last-child{font-size:10px;}
  .tab .ico{font-size:17px;}
}
.tab{
  border:none;background:transparent;
  display:flex;flex-direction:column;align-items:center;gap:4px;
  padding:8px 6px;border-radius:16px;
  color:var(--muted);cursor:pointer;
}
.tab .ico{font-size:18px;line-height:1}
.tab span:last-child{font-size:11px;font-weight:700}
.tab.active{background:rgba(37,99,235,.12);color:var(--text)}
.tab.active .ico{filter:saturate(1.1)}

.modal{
  position:fixed;inset:0;
  display:flex;align-items:flex-end;justify-content:center;
  background:rgba(0,0,0,.25);
  padding:18px;
  z-index:30;
}
.modal.hidden{display:none}
.modalCard{
  width:min(720px, 100%);
  background:var(--card);
  border-radius:22px;
  box-shadow: var(--shadow);
  border:1px solid rgba(0,0,0,.08);
  overflow:hidden;
  max-height:85vh;
  display:flex;flex-direction:column;
}
.modalHead{display:flex;justify-content:space-between;align-items:center;padding:14px 14px 10px;border-bottom:1px solid rgba(0,0,0,.06)}
.modalTitle{font-weight:900}
.modalBody{padding:14px;overflow:auto}
.field{display:flex;flex-direction:column;gap:6px;margin:10px 0}
label{font-size:12px;color:var(--sub);font-weight:800}
input,select,textarea{
  padding:12px;border-radius:14px;border:1px solid rgba(0,0,0,.12);
  background:rgba(255,255,255,.9);color:var(--text);
  outline:none;
}
textarea{min-height:90px;resize:vertical}
.table{width:100%;border-collapse:separate;border-spacing:0 8px}
.tr{background:rgba(0,0,0,.03)}
.tr td{padding:10px 10px;border-top:1px solid rgba(0,0,0,.04);border-bottom:1px solid rgba(0,0,0,.04)}
.tr td:first-child{border-left:1px solid rgba(0,0,0,.04);border-top-left-radius:12px;border-bottom-left-radius:12px}
.tr td:last-child{border-right:1px solid rgba(0,0,0,.04);border-top-right-radius:12px;border-bottom-right-radius:12px;text-align:right}
.small{font-size:12px;color:var(--muted)}
.pill{display:inline-flex;gap:8px;align-items:center;padding:8px 10px;border-radius:999px;background:rgba(0,0,0,.04);font-weight:800}



.pageStack{display:flex;flex-direction:column;gap:16px}

.habitWrap{margin-top:10px;overflow:auto;-webkit-overflow-scrolling:touch}
.habitHeadRow,.habitRow{
  display:grid;
  grid-template-columns: minmax(160px, 1.2fr) repeat(7, 36px);
  gap:8px;
  align-items:center;
}
.habitHeadRow{padding:6px 6px 10px;border-bottom:1px solid rgba(15,23,42,.08);position:sticky;top:0;background:var(--card);z-index:1}
.habitRow{padding:10px 6px;border-bottom:1px solid rgba(15,23,42,.06)}
.habitRow:last-child{border-bottom:none}
.habitName{min-width:160px}
.habitNameInner{display:flex;align-items:center;gap:8px}
.habitIcon{font-size:18px}
.habitText{font-weight:600}
.habitDay{font-size:12px;color:var(--muted);text-align:center}
.habitBox{
  width:28px;height:28px;border-radius:999px;
  border:1px solid rgba(15,23,42,.16);
  background:rgba(15,23,42,.04);
  cursor:pointer;
  transition:transform .08s ease, box-shadow .12s ease, background .12s ease;
  margin:0 auto;
}
.habitBox.on{
  background:rgba(37,99,235,.18);
  border-color:rgba(37,99,235,.55);
  box-shadow:0 6px 14px rgba(37,99,235,.18);
}
.habitBox:active{transform:scale(.96)}
.habitStats{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:12px}
.statMini{background:rgba(15,23,42,.03);border:1px solid rgba(15,23,42,.06);border-radius:14px;padding:10px}
.statLabel{font-size:12px;color:var(--muted)}
.statValue{font-size:18px;font-weight:800;margin-top:4px}
@media (max-width:520px){
  .habitHeadRow,.habitRow{grid-template-columns:minmax(150px,1.2fr) repeat(7, 32px)}
  .habitBox{width:24px;height:24px}
}

/* v6.0 Habit Tracker squares + color */
.habitBox{
  width:28px;height:28px;
  border-radius:8px;
  border:2px solid rgba(15,23,42,.22);
  background: rgba(255,255,255,.22);
  box-shadow: 0 6px 14px rgba(0,0,0,.08);
  cursor:pointer;
}
.habitBox.on{
  background: var(--hc);
  border-color: var(--hc);
}
@media (prefers-color-scheme: dark){
  .habitBox{
    border-color: rgba(148,163,184,.45);
    background: rgba(148,163,184,.10);
  }
}
:root[data-theme="dark"] .habitBox{
  border-color: rgba(148,163,184,.45);
  background: rgba(148,163,184,.10);
}
:root[data-theme="light"] .habitBox{
  border-color: rgba(15,23,42,.22);
  background: rgba(255,255,255,.22);
}

/* v6.0 Habit header typography */
.habitTitle{
  font-size:16px;
  font-weight:900;
  letter-spacing:-0.01em;
}
.habitPeriod{
  font-size:12px;
  font-weight:700;
  color: var(--secondary);
}


/* ===== Balanced Life v6.1.4 (habits sizing + visibility) ===== */

/* Make Habit tracker card match other sections (Dashboard/Weekly) */
.habitSectionFix{ padding:16px; margin:12px 0; }

/* Improve +Навик button visibility in dark / night */
.habitAddBtn{ background: var(--accent) !important; color:#fff !important; border-color: transparent !important; }

/* Week selector pill */
.weekFilter{
  display:flex; align-items:center; gap:8px;
  padding:8px 10px;
  border-radius:999px;
  background: rgba(255,255,255,.10);
  border: 1px solid rgba(255,255,255,.14);
}
:root[data-sky="night"] .weekFilter{
  background: rgba(148,163,184,.10);
  border-color: rgba(148,163,184,.18);
}
.weekFilter select{
  padding:6px 10px;
  border-radius:12px;
}

/* Habit grid contrast */
.habitDay{ color: var(--muted); font-weight: 800; }
.habitBox{
  border-color: rgba(148,163,184,.55) !important;
  background: rgba(148,163,184,.12) !important;
}
:root[data-sky="day"] .habitBox,
:root[data-sky="sunrise"] .habitBox{
  border-color: rgba(15,23,42,.22) !important;
  background: rgba(255,255,255,.22) !important;
}
.habitBox.on{
  box-shadow: 0 10px 22px rgba(0,0,0,.18) !important;
}

/* ===== end v6.1.4 ===== */


/* ===== Deep Night Calm v6.1.5.1 =====
   Applies when :root[data-sky="night"] is active.
   No blur by default. Blur only on .featured cards.
*/

/* No blur by default */
.topbar{ backdrop-filter: none !important; -webkit-backdrop-filter: none !important; }
.bottomnav{ backdrop-filter: none !important; -webkit-backdrop-filter: none !important; }

/* Featured cards only */
.featured{
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}

/* Deep Night Calm palette */
:root[data-sky="night"]{
  --bg:#050814;
  --bgSolid:#050814;

  --card:#0B1C2D;
  --text:#eef2ff;
  --muted:#9aa7bf;
  --sub:#b7d8ff;
  --accent:#60a5fa;

  --shadow: 0 8px 24px rgba(0,0,0,0.35);
  --shadow2: 0 8px 24px rgba(0,0,0,0.35);

  --cardBorder: rgba(255,255,255,0.06);
  --cardDivider: rgba(255,255,255,0.04);

  /* Your gradient + subtle glow */
  --sky1: rgba(15,58,79,.08);  /* Accent glow 5–8% */
  --sky2: rgba(12,36,54,1);    /* Gradient Top */
  --sky3: rgba(5,8,20,1);      /* Gradient Bottom */
}

/* Make background use sky tokens (safe override) */
body{
  background:
    radial-gradient(1200px 700px at 15% 10%, var(--sky1), transparent 60%),
    radial-gradient(900px 700px at 85% 20%, var(--sky2), transparent 60%),
    radial-gradient(1000px 800px at 50% 95%, var(--sky3), transparent 60%),
    var(--bgSolid, var(--bg));
}

/* Use border/divider tokens where available */
.card{
  border: 1px solid var(--cardBorder, rgba(0,0,0,.06));
  box-shadow: var(--shadow);
}
.modalCard{ border: 1px solid var(--cardBorder, rgba(0,0,0,.08)); }
.modalHead{ border-bottom: 1px solid var(--cardDivider, rgba(0,0,0,.06)); }

/* Night topbar/bottomnav without blur */
:root[data-sky="night"] .topbar{
  background: linear-gradient(180deg, rgba(5,8,20,.92), rgba(5,8,20,.65));
}
:root[data-sky="night"] .bottomnav{
  background: rgba(11,28,45,.92);
  border: 1px solid rgba(255,255,255,0.08);
}

/* Featured card surface */
.featured{
  background: rgba(11,28,45,.70);
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: 0 10px 28px rgba(0,0,0,0.42);
}

/* ===== end v6.1.5.1 ===== */


/* ===== Sky Day Premium v6.1.7 =====
   Cleaner blue sky + subtle sun glow.
   Featured blur ONLY in light mode.
*/

/* Sky Day refined palette */
:root[data-sky="day"]{
  --bg:#eef5ff;
  --bgSolid:#eef5ff;

  /* cleaner blue sky */
  --sky1: rgba(56,189,248,.22);   /* soft blue */
  --sky2: rgba(59,130,246,.18);   /* sky blue */
  --sky3: rgba(250,204,21,.16);   /* sun glow */

  --card:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --sub:#1e40af;

  --shadow: 0 12px 28px rgba(15,23,42,.12);
  --shadow2: 0 8px 20px rgba(15,23,42,.10);
}

/* Ensure no blur by default in light */
:root[data-sky="day"] .topbar,
:root[data-sky="day"] .bottomnav{
  backdrop-filter:none !important;
  -webkit-backdrop-filter:none !important;
}

/* Featured cards: very subtle blur in light */
:root[data-sky="day"] .featured{
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  background: rgba(255,255,255,.78);
  border: 1px solid rgba(15,23,42,.08);
  box-shadow: 0 14px 32px rgba(15,23,42,.16);
}

/* ===== end v6.1.7 ===== */


/* ===== v6.1.3 weekly tiles ===== */
.weekTiles{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:12px}
@media (max-width:740px){.weekTiles{grid-template-columns:1fr}}
.weekTile{
  text-align:left;width:100%;border:none;padding:14px;border-radius:18px;cursor:pointer;
  background: rgba(255,255,255,.10);
  border: 1px solid rgba(255,255,255,.16);
  box-shadow: var(--shadow2);
  color: var(--text);
}
:root[data-sky="night"] .weekTile{background: rgba(11,28,45,.80); border-color: rgba(255,255,255,0.08);}
.weekTileTop{display:flex;align-items:center;justify-content:space-between;gap:10px}
.weekTileTitle{font-size:14px;font-weight:900;letter-spacing:-0.01em}
.weekTileIcon{font-size:18px;opacity:.95}
.weekTileValue{margin-top:10px;font-size:22px;font-weight:950}
.weekTileSub{margin-top:4px;font-size:var(--fs-small);color:var(--muted);font-weight:700}


/* ===== v6.1.4 habits UI visibility ===== */
.habitTitle{font-size:var(--fs-title);font-weight:900;letter-spacing:-0.01em}
.habitPeriod{font-size:var(--fs-small);font-weight:800;color:var(--muted)}
.habitAddBtn{background:var(--accent)!important;color:#fff!important;border-color:transparent!important}
.weekFilter{
  display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;
  background: rgba(255,255,255,.10); border: 1px solid rgba(255,255,255,.14);
}
:root[data-sky="night"] .weekFilter{background: rgba(255,255,255,.06);border-color: rgba(255,255,255,.10);}
.weekFilter select{padding:6px 10px;border-radius:12px}


/* ===== v6.1.3 preset habit buttons ===== */
.presetGrid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}
@media (max-width:520px){.presetGrid{grid-template-columns:1fr}}
.presetBtn{
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:10px 12px;border-radius:16px;
  border:1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.10);
  box-shadow: var(--shadow2);
  cursor:pointer;
  color: var(--text);
}
:root[data-sky="night"] .presetBtn{background: rgba(11,28,45,.80);border-color: rgba(255,255,255,0.10);}
.presetLeft{display:flex;align-items:center;gap:10px}
.presetIcon{font-size:18px}
.presetName{font-weight:900}
.presetMeta{font-size:var(--fs-small);color:var(--muted);font-weight:700}
.presetAdd{font-weight:950;opacity:.9}


/* ===== v6.2.6 polish (energy ring + weekly tiles + week select readability) ===== */

/* Energy ring visibility in night */
:root[data-sky="night"] .kpiRing,
:root[data-sky="night"] .ring,
:root[data-sky="night"] svg circle{
  /* safe: only affects inside widget due to inline attrs being stronger; we override via classes below too */
}
:root[data-sky="night"] .energyWrap{
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
}
:root[data-sky="night"] .energyLabel{
  color: rgba(255,255,255,0.86);
}

/* Weekly tiles bigger */
.weekTile{
  padding:18px !important;
  border-radius:20px !important;
}
.weekTileTitle{ font-size: 15px !important; }
.weekTileValue{ font-size: 28px !important; }
.weekTileSub{ font-size: 12px !important; line-height:1.25; }

/* Week selector readability */
.weekFilter{
  background: rgba(255,255,255,.12) !important;
  border-color: rgba(255,255,255,.18) !important;
}
.weekFilter select{
  background: rgba(255,255,255,.16) !important;
  border: 1px solid rgba(255,255,255,.18) !important;
  color: var(--text) !important;
}
:root[data-sky="night"] .weekFilter select{
  background: rgba(255,255,255,.06) !important;
  border-color: rgba(255,255,255,.14) !important;
  color: rgba(255,255,255,.92) !important;
}

/* Habit tracker range typography: make digits match */
.habitRange{
  font-size: 14px;
  font-weight: 900;
  letter-spacing:-0.01em;
  color: var(--text);
}
.habitRange .mutedInline{
  color: var(--muted);
  font-weight: 800;
}
/* ===== end v6.2.6 ===== */


/* ===== v6.2.9 Dashboard donuts ===== */
.donutRow{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:14px}
@media (max-width:820px){.donutRow{grid-template-columns:1fr;gap:12px}}
.donutCard{display:flex;align-items:center;justify-content:center;padding:14px;border-radius:22px;border:1px solid rgba(255,255,255,0.10);background: rgba(255,255,255,0.06);box-shadow: var(--shadow2);}
:root[data-sky="day"] .donutCard{background: rgba(255,255,255,.60); border-color: rgba(15,23,42,0.08);}
:root[data-sky="night"] .donutCard{background: rgba(11,28,45,.60); border-color: rgba(255,255,255,0.10);}
.donut{width:150px;height:150px; position:relative; display:grid; place-items:center;}
.donut svg{width:150px;height:150px; transform: rotate(-90deg);}
.donut .center{position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center;}
.donut .center .t{font-size:12px;font-weight:900;color:var(--muted);letter-spacing:-0.01em}
.donut .center .v{font-size:34px;font-weight:950;line-height:1;color:var(--text)}
.donut .center .s{font-size:12px;font-weight:800;color:var(--muted);margin-top:2px}
.donutTrack{stroke: rgba(148,163,184,.18);}
:root[data-sky="night"] .donutTrack{stroke: rgba(255,255,255,.10);}
.donutArc{stroke-linecap:round; filter: drop-shadow(0px 8px 16px rgba(0,0,0,0.25));}
/* ===== end v6.2.9 ===== */


/* ===== v6.3.0 Glass background (like reference) ===== */
body{
  /* warm bokeh-ish background without images */
  background:
    radial-gradient(1200px 700px at 10% 15%, rgba(255,190,120,0.55), rgba(255,190,120,0.0) 60%),
    radial-gradient(900px 520px at 80% 20%, rgba(255,120,90,0.35), rgba(255,120,90,0.0) 58%),
    radial-gradient(900px 650px at 65% 80%, rgba(120,190,255,0.30), rgba(120,190,255,0.0) 60%),
    radial-gradient(1000px 700px at 20% 85%, rgba(200,160,255,0.24), rgba(200,160,255,0.0) 62%),
    linear-gradient(180deg, #050814 0%, #071321 45%, #050814 100%);
  background-attachment: fixed;
}
/* keep themes but give "glass" top overlay */
:root[data-theme="light"] body{
  background:
    radial-gradient(1100px 680px at 15% 15%, rgba(255,210,150,0.65), rgba(255,210,150,0.0) 60%),
    radial-gradient(900px 520px at 80% 22%, rgba(255,150,120,0.40), rgba(255,150,120,0.0) 58%),
    radial-gradient(900px 650px at 70% 78%, rgba(130,200,255,0.38), rgba(130,200,255,0.0) 60%),
    radial-gradient(1000px 700px at 25% 85%, rgba(210,190,255,0.30), rgba(210,190,255,0.0) 62%),
    linear-gradient(180deg, #EAF2FF 0%, #F7FAFF 60%, #EAF2FF 100%);
}

/* Glass shell: blur only on main wrapper like reference */
.wrap{
  background: rgba(8, 16, 28, 0.28);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 26px;
  box-shadow: 0px 18px 60px rgba(0,0,0,0.35);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
}
:root[data-theme="light"] .wrap{
  background: rgba(255,255,255,0.58);
  border-color: rgba(15,23,42,0.10);
  box-shadow: 0px 18px 60px rgba(2, 6, 23, 0.14);
}

/* make cards a bit more glassy to match reference */
.card{
  background: rgba(11,28,45,0.55);
  border-color: rgba(255,255,255,0.10);
}
:root[data-theme="light"] .card{
  background: rgba(255,255,255,0.65);
  border-color: rgba(15,23,42,0.08);
}

/* ===== end v6.3.0 ===== */


/* ===== v6.3.1 Dashboard radial fixes ===== */
.donut{width:220px;height:220px}
.donut svg{width:220px;height:220px; transform:none !important;} /* text upright */
@media (max-width:820px){
  .donut{width:200px;height:200px}
  .donut svg{width:200px;height:200px}
}
/* make the 3 rings feel like "graphics" not tiles */
.donutCard{background: transparent; border-color: rgba(255,255,255,0.10);}
:root[data-theme="light"] .donutCard{background: rgba(255,255,255,0.25);}
/* ===== end v6.3.1 ===== */


/* ===== v6.3.2 Habit tracker + dashboard fixes ===== */
.habitTitle{font-size:22px;font-weight:900;letter-spacing:-0.02em;color:var(--text)}
.habitRange{font-size:13px;font-weight:800;color:var(--muted)}
/* make habit boxes visible + fill on check */
.habitBox{
  width:28px;height:28px;border-radius:8px;
  border:1px solid rgba(255,255,255,0.16);
  background:rgba(255,255,255,0.06);
}
:root[data-theme="light"] .habitBox{
  border:1px solid rgba(15,23,42,0.16);
  background:rgba(15,23,42,0.04);
}
.habitBox.on{
  background:rgba(37,99,235,0.55);
  border-color:rgba(96,165,250,0.85);
  box-shadow:0 10px 18px rgba(37,99,235,0.25);
}
/* ===== end v6.3.2 ===== */


/* ===== v6.3.3 language switch ===== */
.topActions{display:flex;gap:10px;align-items:center}
.langSwitch{display:flex;gap:6px;align-items:center}
.langBtn{min-width:44px}
.langBtn.isActive{
  box-shadow: 0 0 0 2px rgba(255,255,255,0.18) inset, 0px 10px 24px rgba(0,0,0,0.25);
}
:root[data-theme="light"] .langBtn.isActive{
  box-shadow: 0 0 0 2px rgba(15,23,42,0.12) inset, 0px 10px 24px rgba(2,6,23,0.12);
}
/* ===== end v6.3.3 ===== */


/* ===== v6.4.0 Language toggle (EN/BG) ===== */
.langToggle{
  position:relative;
  width:112px;
  height:38px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,0.16);
  background: rgba(255,255,255,0.10);
  box-shadow: 0 0 0 2px rgba(255,255,255,0.08) inset, 0px 10px 24px rgba(0,0,0,0.22);
  padding:0;
  display:flex;
  align-items:center;
  justify-content:space-between;
  overflow:hidden;
}

:root[data-theme="light"] .langToggle{
  border-color: rgba(15,23,42,0.10);
  background: rgba(255,255,255,0.55);
  box-shadow: 0 0 0 2px rgba(15,23,42,0.06) inset, 0px 10px 24px rgba(2,6,23,0.12);
}

.langToggle:focus-visible{outline:2px solid rgba(96,165,250,0.65); outline-offset:3px;}

.langToggle .langLabel{
  flex:1;
  text-align:center;
  font-size:12px;
  font-weight:950;
  letter-spacing:0.06em;
  z-index:2;
  color: rgba(255,255,255,0.70);
  user-select:none;
}
:root[data-theme="light"] .langToggle .langLabel{color: rgba(15,23,42,0.55);}

.langToggle .langThumb{
  position:absolute;
  top:4px;
  left:4px;
  width:30px;
  height:30px;
  border-radius:999px;
  background: rgba(15,23,42,0.70);
  box-shadow: 0 8px 18px rgba(0,0,0,0.35), 0 0 0 2px rgba(255,255,255,0.10) inset;
  transition: transform 180ms ease, background 180ms ease;
}
:root[data-theme="light"] .langToggle .langThumb{
  background: rgba(15,23,42,0.35);
  box-shadow: 0 8px 18px rgba(2,6,23,0.18), 0 0 0 2px rgba(255,255,255,0.35) inset;
}

/* Active state = BG (thumb right + warm fill like reference) */
.langToggle.isBG{
  background: linear-gradient(90deg, rgba(251,146,60,0.95), rgba(239,68,68,0.88));
  border-color: rgba(255,255,255,0.18);
}
:root[data-theme="light"] .langToggle.isBG{
  background: linear-gradient(90deg, rgba(251,146,60,0.95), rgba(239,68,68,0.88));
  border-color: rgba(255,255,255,0.45);
}
.langToggle.isBG .langThumb{transform: translateX(74px);}

/* Label emphasis */
.langToggle:not(.isBG) .langLabel.left{color: rgba(255,255,255,0.95);} 
.langToggle.isBG .langLabel.right{color: rgba(255,255,255,0.95);} 
:root[data-theme="light"] .langToggle:not(.isBG) .langLabel.left{color: rgba(15,23,42,0.85);} 
:root[data-theme="light"] .langToggle.isBG .langLabel.right{color: rgba(255,255,255,0.95);} 

/* ===== end v6.4.0 ===== */


/* ===== v6.3.4 Mobile layout + habit box contrast ===== */
.app{box-sizing:border-box;width:100%;}
*{box-sizing:border-box;}

body{overflow-x:hidden;}

@media (max-width:640px){
  .app{max-width:100%;width:100%;margin:0 auto;padding:12px 12px 96px;}
  .pageStack{gap:14px;}
  .card.section{padding:16px;}
  .donutRow{grid-template-columns:1fr; justify-items:center;}
  .donutCard{width:100%; display:flex; justify-content:center;}
}

/* Habit tracker: make boxes visible in dark + stronger "on" */
:root[data-theme="dark"] .habitBox{
  border:1px solid rgba(255,255,255,0.16);
  background:rgba(255,255,255,0.05);
}
:root[data-theme="dark"] .habitBox.on{
  background:rgba(96,165,250,0.65);
  border-color:rgba(147,197,253,0.95);
  box-shadow:0 10px 22px rgba(96,165,250,0.30);
}
:root[data-theme="light"] .habitBox.on{
  background:rgba(37,99,235,0.30);
  border-color:rgba(37,99,235,0.75);
  box-shadow:0 10px 22px rgba(37,99,235,0.20);
}

/* Ensure checked squares are always visible (use habit color) */
.habitBox.on{background:var(--hc, rgba(96,165,250,0.65)) !important; border-color:var(--hc, rgba(147,197,253,0.95)) !important;}
.habitBox.on::after{content:"✓"; display:block; color:white; font-weight:900; font-size:14px; line-height:1;}
.habitBox{display:grid; place-items:center;}

/* Dashboard donut meta + quick actions */
.donutStack{display:flex; flex-direction:column; align-items:center; gap:8px; width:100%;}
.donutMeta{font-size:12px; font-weight:800; color:var(--muted); text-align:center; line-height:1.25;}
.dashActions{display:flex; gap:10px; margin-top:14px; flex-wrap:wrap;}
.dashActions .btn{padding:10px 12px; border-radius:14px;}

@media (max-width:640px){
  .dashActions{gap:8px;}
  .dashActions .btn{flex:1 1 auto; min-width:120px; justify-content:center;}
}
/* ===== end v6.3.4 ===== */

/* ===== v6.3.8 Add button pill + Habit mobile spacing ===== */
.btn.addPill{padding:0;border:0;background:transparent;box-shadow:none}
.addPillInner{display:flex;align-items:center;gap:12px;border-radius:999px;padding:10px 10px 10px 18px;background:linear-gradient(90deg, rgba(251,146,60,0.95), rgba(239,68,68,0.88));box-shadow:0px 10px 26px rgba(0,0,0,0.22)}
:root[data-theme="light"] .addPillInner{box-shadow:0px 10px 26px rgba(2,6,23,0.12)}
.addPillText{font-weight:900;font-size:13px;color:#fff;letter-spacing:-0.01em}
.addPillPlus{width:38px;height:38px;border-radius:999px;background:rgba(255,255,255,0.88);display:grid;place-items:center;color:rgba(15,23,42,0.85);font-weight:950;font-size:22px;line-height:1}
.btn.addPill:active .addPillInner{transform:translateY(1px)}
.btn.addPill.smallAdd .addPillInner{padding:8px 8px 8px 14px}
.btn.addPill.smallAdd .addPillPlus{width:32px;height:32px;font-size:20px}

/* Habit tracker mobile: prevent "squeezed" grid */
@media (max-width:640px){
  .habitWrap{overflow-x:auto;padding-bottom:6px}
  .habitHeadRow,.habitRow{min-width:560px}
  .habitBox{width:34px;height:34px}
  .habitTitle{font-size:22px}
  .habitRange{font-size:12px}
  .habitSectionFix .cardHead{flex-direction:column;align-items:stretch;gap:12px}
  .habitSectionFix .cardHead>div:last-child{justify-content:space-between}
  .weekFilter{flex:1 1 auto}
}
/* ===== end v6.3.8 ===== */

/* ===== v6.3.5 Mobile overflow + habit mark visibility ===== */
html,body{overflow-x:hidden;}

@media (max-width:640px){
  .topbar{flex-wrap:wrap; gap:10px;}
  .brand{min-width:0;}
  .brandTitle{max-width:60vw; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
  .topActions{flex-wrap:wrap; justify-content:flex-end;}
  .card{max-width:100%;}
}

.habitBox.on{
  background: var(--hc, rgba(37,99,235,0.85)) !important;
  border-color: rgba(255,255,255,0.65) !important;
  box-shadow: 0 10px 22px rgba(0,0,0,0.18), 0 10px 22px color-mix(in srgb, var(--hc, #3b82f6) 35%, transparent);
}
.habitBox.on::after{
  content: "✓";
  display:block;
  width:100%; height:100%;
  color: rgba(255,255,255,0.95);
  font-weight: 900;
  font-size: 14px;
  line-height: 26px;
  text-align:center;
}
:root[data-theme="light"] .habitBox.on::after{color: rgba(15,23,42,0.92);}
/* ===== end v6.3.5 ===== */


/* ===== v6.3.5 Habit on-state + mobile overflow fix ===== */
body{overflow-x:hidden;}
.topbar{flex-wrap:wrap;gap:10px}
.brand{min-width:0}
.topActions{flex-wrap:wrap;justify-content:flex-end}

.habitBox{position:relative}
.habitBox.on{
  background: var(--hc, #2563eb) !important;
  border-color: var(--hc, #2563eb) !important;
  box-shadow: 0 10px 20px rgba(37,99,235,0.22) !important;
}
.habitBox.on::after{
  content:"✓";
  position:absolute; inset:0;
  display:grid; place-items:center;
  color:white;
  font-size:14px;
  font-weight:900;
}

@media (max-width:640px){
  .card{max-width:100%}
  .donutCard{max-width:100%}
}
/* ===== end v6.3.5 ===== */







/* ===== v6.3.5 Habit box on-state + mobile overflow fix ===== */
body{overflow-x:hidden}
.topbar{flex-wrap:wrap;row-gap:10px}
.topActions{flex-wrap:wrap;justify-content:flex-end}
.brand{min-width:0}
.brandTitle{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:220px}

.habitBox.on{
  background: var(--hc, rgba(37,99,235,0.70)) !important;
  border-color: var(--hc, rgba(96,165,250,0.95)) !important;
  box-shadow: 0 10px 22px rgba(0,0,0,0.18), 0 10px 22px rgba(96,165,250,0.22);
}
.habitBox.on::after{
  content: "✓";
  display:grid;
  place-items:center;
  width:100%;
  height:100%;
  color: rgba(255,255,255,0.95);
  font-size: 16px;
  font-weight: 900;
  text-shadow: 0 6px 14px rgba(0,0,0,0.25);
}
:root[data-theme="light"] .habitBox.on::after{color: rgba(15,23,42,0.90)}

@media (max-width:640px){
  .card{max-width:100%}
  .view{padding:8px 0}
}
/* ===== end v6.3.5 ===== */



/* ===== v6.3.7 Preset habits ===== */
.presetGrid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px}
@media (max-width:820px){.presetGrid{grid-template-columns:repeat(3,1fr)}}
@media (max-width:420px){.presetGrid{grid-template-columns:repeat(2,1fr)}}
.presetBtn{display:flex;align-items:center;gap:8px;justify-content:flex-start;padding:10px 10px;border-radius:14px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.06);cursor:pointer}
:root[data-theme="light"] .presetBtn{border-color:rgba(15,23,42,0.10);background:rgba(255,255,255,0.65)}
.presetBtn:hover{transform:translateY(-1px)}
.presetEmoji{font-size:18px}
.presetName{font-size:12px;font-weight:900;line-height:1.1}
.presetTag{font-size:11px;color:var(--muted);font-weight:700;margin-top:2px}
/* ===== end v6.3.7 ===== */

/* ===== v6.3.9 Interactions: chart shortcuts + tap bounce + habit fill animation ===== */

/* Donut cards are now buttons (shortcuts) */
.donutCardLink{border:none;cursor:pointer;text-align:left;}
.donutCardLink:focus-visible{outline:2px solid rgba(96,165,250,0.65);outline-offset:3px;}

.tapBounce{animation:tapBounce 220ms ease-out;}
@keyframes tapBounce{
  0%{transform:scale(1)}
  45%{transform:scale(0.97)}
  100%{transform:scale(1)}
}

/* Habit tracker: fill animation instead of static look */
.habitBox{position:relative;overflow:hidden;}
.habitBox::before{
  content:"";
  position:absolute;
  inset:0;
  background:var(--hc, #60a5fa);
  opacity:0.85;
  transform:scale(0);
  border-radius:10px;
  transition:transform 180ms ease-out, opacity 180ms ease-out;
}
.habitBox.on::before{transform:scale(1);}
.habitBox::after{
  content:"✓";
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  color:rgba(255,255,255,0.95);
  text-shadow:0 6px 14px rgba(0,0,0,0.35);
  opacity:0;
  transform:scale(0.6);
  transition:opacity 160ms ease-out, transform 160ms ease-out;
}
.habitBox.on::after{opacity:1;transform:scale(1);}

.habitBox.pulse.on::before{animation:hbFillPop 220ms ease-out;}
.habitBox.pulse.on::after{animation:hbCheckPop 220ms ease-out;}
@keyframes hbFillPop{
  0%{transform:scale(0)}
  70%{transform:scale(1.06)}
  100%{transform:scale(1)}
}
@keyframes hbCheckPop{
  0%{opacity:0;transform:scale(0.6)}
  70%{opacity:1;transform:scale(1.1)}
  100%{opacity:1;transform:scale(1)}
}

/* ===== end v6.3.9 ===== */


/* ===== v6.4.1 Habits page + comfy week + responsive home habits ===== */
.homeHabitsLink{display:none; cursor:pointer;}
.homeHabitsInline{display:block;}
@media (max-width:640px){
  .homeHabitsInline{display:none;}
  .homeHabitsLink{display:block;}
}

.weekComfy{position:relative; display:flex; align-items:center; gap:10px; padding:10px 14px; border-radius:999px;
  background:linear-gradient(135deg, rgba(255,255,255,0.10), rgba(255,255,255,0.04));
  border:1px solid rgba(255,255,255,0.12);
  box-shadow:0 10px 22px rgba(0,0,0,0.18);
  min-width:180px;
}
:root[data-theme="light"] .weekComfy{background:linear-gradient(135deg, rgba(255,255,255,0.75), rgba(255,255,255,0.35)); border:1px solid rgba(0,0,0,0.06);}
.weekComfyLabel{font-weight:900; font-size:12px; opacity:0.85;}
.weekComfyPill{display:flex; align-items:center; justify-content:space-between; gap:10px; width:100%; padding:10px 14px; border-radius:999px;
  background:linear-gradient(90deg, rgba(255,167,90,0.95), rgba(255,111,0,0.95));
  box-shadow:inset 0 1px 0 rgba(255,255,255,0.28), 0 12px 26px rgba(0,0,0,0.28);
  color:#fff;
}
.weekComfyCaret{font-weight:900; opacity:0.9;}
:root[data-theme="light"] .weekComfyPill{box-shadow:inset 0 1px 0 rgba(255,255,255,0.55), 0 10px 22px rgba(0,0,0,0.12);}

.weekComfyValue{font-weight:900; font-size:13px;}
.weekComfySelect{position:absolute; inset:0; opacity:0; cursor:pointer;}

@media (max-width:520px){
  .weekComfy{width:100%; min-width:0;}
  .weekComfyPill{width:100%;}
  .weekComfyValue{font-size:12px; line-height:1.15; white-space:normal;}
}

.insightRow{margin-top:10px; padding:10px 12px; border-radius:14px; background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.06); font-weight:800; color:var(--text);}
:root[data-theme="light"] .insightRow{background:rgba(0,0,0,0.03); border:1px solid rgba(0,0,0,0.06);}
/* ===== end v6.4.1 ===== */

/* ===== Nutrition v6.6.0 (modern) ===== */
.grid3{display:grid; grid-template-columns:repeat(3, minmax(0,1fr)); gap:12px;}
@media (max-width:520px){ .grid3{grid-template-columns:1fr; } }

.nutriHead{display:flex;justify-content:space-between;align-items:flex-start;gap:14px; flex-wrap:wrap;}
.nutriHeadRight{display:flex;gap:12px;align-items:center; flex-wrap:wrap; justify-content:flex-end;}
.nutriDate{display:flex; flex-direction:column; gap:6px; padding:10px 12px; border-radius:16px; background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.08);}
:root[data-theme="light"] .nutriDate{background:rgba(0,0,0,0.03); border:1px solid rgba(0,0,0,0.08);}
.nutriDateInput{appearance:none; border:0; background:transparent; color:var(--text); font-weight:900; padding:0;}
.nutriOverview{display:grid; grid-template-columns:220px 1fr; gap:14px; margin-top:12px; align-items:stretch;}
@media (max-width:780px){ .nutriOverview{grid-template-columns:1fr; } }

.nutriRing{display:flex; flex-direction:column; align-items:center; justify-content:center; gap:8px; padding:12px; border-radius:18px; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06);}
:root[data-theme="light"] .nutriRing{background:rgba(0,0,0,0.03); border:1px solid rgba(0,0,0,0.06);} 
.nutriRingSub{font-weight:900; color:var(--sub);}

.nutriRight{display:flex; flex-direction:column; gap:10px;}
.nutriGoalsRow{display:flex; gap:10px; flex-wrap:wrap;}
.nutriPill{display:flex; flex-direction:column; gap:2px; padding:10px 12px; border-radius:16px; background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.07);}
:root[data-theme="light"] .nutriPill{background:rgba(0,0,0,0.03); border:1px solid rgba(0,0,0,0.08);} 
.nutriPill b{font-weight:950;}

.nutriMacro{padding:10px 12px; border-radius:16px; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06);}
:root[data-theme="light"] .nutriMacro{background:rgba(0,0,0,0.03); border:1px solid rgba(0,0,0,0.06);} 
.nutriMacroTop{display:flex; justify-content:space-between; align-items:center; gap:12px;}
.nutriMacroLabel{font-weight:950;}
.nutriMacroVal{font-weight:900; color:var(--sub);}
.nutriBar{height:10px; border-radius:999px; background:rgba(255,255,255,0.10); overflow:hidden; margin-top:10px;}
:root[data-theme="light"] .nutriBar{background:rgba(0,0,0,0.12);} 
.nutriBarFill{height:100%; border-radius:999px; width:0%; transition:width 380ms cubic-bezier(.2,.9,.2,1);} 
.nutriBarFill.p{background:linear-gradient(90deg, rgba(34,197,94,0.95), rgba(16,185,129,0.95));}
.nutriBarFill.c{background:linear-gradient(90deg, rgba(96,165,250,0.95), rgba(59,130,246,0.95));}
.nutriBarFill.f{background:linear-gradient(90deg, rgba(251,146,60,0.95), rgba(239,68,68,0.95));}

.nutriActions{display:flex; gap:10px; flex-wrap:wrap;}
.nutriQuickGrid{display:grid; grid-template-columns:repeat(3, minmax(0,1fr)); gap:10px; margin-top:12px;}
@media (max-width:620px){ .nutriQuickGrid{grid-template-columns:repeat(2, minmax(0,1fr));} }
.nutriQuickBtn{display:flex; flex-direction:column; align-items:flex-start; gap:6px; padding:12px; border-radius:18px; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06); color:var(--text); text-align:left;}
:root[data-theme="light"] .nutriQuickBtn{background:rgba(0,0,0,0.03); border:1px solid rgba(0,0,0,0.06);} 
.nutriQuickBtn:active{transform:scale(0.98);}
.nutriQuickEmoji{font-size:20px;}
.nutriQuickName{font-weight:950;}
.nutriQuickKcal{font-weight:900; color:var(--sub);}

.nutriLogHead{display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;}
.nutriMeals{display:flex; flex-direction:column; gap:12px; margin-top:12px;}
.nutriMeal{padding:12px; border-radius:18px; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06);} 
:root[data-theme="light"] .nutriMeal{background:rgba(0,0,0,0.03); border:1px solid rgba(0,0,0,0.06);} 
.nutriMealHead{display:flex; justify-content:space-between; align-items:center; gap:12px;}
.nutriMealTitle{font-weight:950;}
.nutriMealMeta{font-weight:900; color:var(--sub);}
.nutriList{display:flex; flex-direction:column; gap:10px; margin-top:10px;}
.nutriEmpty{padding:12px; border-radius:16px; background:rgba(255,255,255,0.02); border:1px dashed rgba(255,255,255,0.10); color:var(--sub); font-weight:800;}
:root[data-theme="light"] .nutriEmpty{background:rgba(0,0,0,0.02); border:1px dashed rgba(0,0,0,0.12);} 

.nutriItem{display:flex; align-items:center; gap:12px; padding:10px; border-radius:18px; background:rgba(0,0,0,0.10); border:1px solid rgba(255,255,255,0.06);} 
:root[data-theme="light"] .nutriItem{background:rgba(255,255,255,0.7);}
.nutriThumb{width:44px; height:44px; border-radius:14px; object-fit:cover; flex:0 0 44px;}
.nutriThumb.ph{display:flex; align-items:center; justify-content:center; font-weight:950; background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.08); color:var(--text);} 
:root[data-theme="light"] .nutriThumb.ph{background:rgba(0,0,0,0.05); border:1px solid rgba(0,0,0,0.08);} 
.nutriItemMain{flex:1; min-width:0;}
.nutriItemTop{display:flex; justify-content:space-between; align-items:baseline; gap:10px;}
.nutriItemName{font-weight:950; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
.nutriItemKcal{font-weight:950;}
.nutriItemSub{display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-top:6px;}
.nutriDel{padding:10px 12px; border-radius:14px;}

.nutriPhotoPrev{margin-top:10px; border-radius:16px; overflow:hidden; border:1px solid rgba(255,255,255,0.08);}
:root[data-theme="light"] .nutriPhotoPrev{border:1px solid rgba(0,0,0,0.08);} 
.nutriPhotoPrev img{display:block; width:100%; max-height:180px; object-fit:cover;}

.nutriCalcResult{padding:12px; border-radius:16px; background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.08); font-weight:950; text-align:center;}
:root[data-theme="light"] .nutriCalcResult{background:rgba(0,0,0,0.03); border:1px solid rgba(0,0,0,0.08);} 

/* Toast */
.toast{position:fixed; left:50%; bottom:86px; transform:translateX(-50%) translateY(16px); opacity:0; padding:10px 12px; border-radius:999px; background:rgba(0,0,0,0.75); color:#fff; font-weight:900; letter-spacing:0.2px; z-index:9999; border:1px solid rgba(255,255,255,0.10); box-shadow:0 16px 30px rgba(0,0,0,0.25); transition:transform 220ms cubic-bezier(.2,.9,.2,1), opacity 220ms cubic-bezier(.2,.9,.2,1);} 
.toast.show{opacity:1; transform:translateX(-50%) translateY(0);} 
/* ===== end Nutrition v6.6.0 ===== */

