
:root{
  --bg:#eef1f5;
  --card:#ffffff;
  --text:#111827;
  --sub:#1e3a8a; /* dark blue secondary */
  --muted:#6b7280;
  --shadow: 0 14px 40px rgba(0,0,0,.12);
  --shadow2: 0 10px 24px rgba(0,0,0,.10);
  --radius:18px;
  --radius2:14px;
  --accent:#2563eb;
}

@media (prefers-color-scheme: dark){
  :root{
    --bg:#0b1020;
    --card:#121a2f;
    --text:#eef2ff;
    --sub:#93c5fd;
    --muted:#94a3b8;
    --shadow: 0 18px 55px rgba(0,0,0,.45);
    --shadow2: 0 12px 32px rgba(0,0,0,.35);
    --accent:#60a5fa;
  }
}

*{box-sizing:border-box}
html,body{height:100%}

/* Global premium background image */
body::before{
  content:'';
  position:fixed;
  inset:0;
  background:url('background.png') center/cover no-repeat;
  z-index:-2;
}
body::after{
  content:'';
  position:fixed;
  inset:0;
  /* subtle dark overlay so text stays readable while keeping the background image visible */
  background: linear-gradient(180deg, rgba(5,10,20,.55), rgba(5,10,20,.68));
  z-index:-1;
  pointer-events:none;
}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  color:var(--text);
  background: transparent;
}

.app{max-width:980px;margin:0 auto;min-height:100%;padding:14px 14px 96px}
.topbar{
  position:sticky;
  top:0;
  z-index:10;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:16px 12px 20px;
  border-radius:18px;
  background:
    radial-gradient(900px circle at 80% 20%, rgba(99,102,241,0.25), transparent 60%),
    radial-gradient(700px circle at 20% 80%, rgba(56,189,248,0.2), transparent 55%),
    linear-gradient(180deg, #020617, #0F172A);
  backdrop-filter: blur(14px);
}

.brandTitle{
  font-weight:700;
  letter-spacing:-0.02em;
}

.brandSub{
  font-size:12px;
  opacity:.7;
}
.btn{
  border:1px solid rgba(0,0,0,.08);
  background:rgba(255,255,255,.85);
  color:var(--text);
  padding:10px 12px;
  border-radius:14px;
  box-shadow: var(--shadow2);
  cursor:pointer;
  transition: transform .12s ease, box-shadow .16s ease, background .16s ease, border-color .16s ease;
}
.btn.ghost{background:rgba(255,255,255,.55)}
.btn.primary{background:var(--accent);color:white;border-color:transparent}
.btn:active{transform:translateY(1px) scale(.99)}

@media (hover:hover){
  .btn:hover{transform:translateY(-1px)}
  .logo:hover{transform:translateY(-1px) scale(1.02)}
  .tab:hover{transform:translateY(-1px);background:rgba(255,255,255,.06)}
}
.view{padding:8px 2px}
.card{
  background:var(--card);
  border-radius:var(--radius);
  box-shadow: var(--shadow);
  border:1px solid rgba(0,0,0,.06);
}
.section{padding:16px;margin:12px 0}
.h1{font-size:18px;font-weight:900;margin:0 0 6px}
.sub{color:var(--sub);font-weight:700;font-size:13px}
.row{display:flex;gap:12px;flex-wrap:wrap}
.kpi{flex:1;min-width:200px;padding:14px;border-radius:var(--radius2);background:rgba(0,0,0,.03)}
.kpi .v{font-size:22px;font-weight:900}
.kpi .l{font-size:12px;color:var(--sub);font-weight:700}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width:740px){.grid2{grid-template-columns:1fr}}

.bottomnav{
  position:fixed;
  left:50%;
  transform:translateX(-50%);
  bottom:calc(18px + env(safe-area-inset-bottom));
  z-index:20;

  width:min(920px, calc(100% - 28px));
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap:10px;

  padding:12px 12px 10px;
  border-radius:26px;

  border:1px solid transparent;
  background:
    linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04)) padding-box,
    linear-gradient(90deg, rgba(56,189,248,.35), rgba(168,85,247,.25), rgba(251,191,36,.22)) border-box;

  box-shadow: 0 18px 55px rgba(0,0,0,.55);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

/* ------------------------------------------------------------
   v9.9.1 — Neon Bottom Navigation + Icon System (inline SVG only)
   Matches the provided reference: neon icons + labels on a
   purple bar. NO image icons are used.
------------------------------------------------------------- */

.bottomnav.neonNav{
  align-items:center;
  padding:14px 14px 12px;
  border-radius:28px;
  border:1px solid rgba(255,255,255,.14);
  /* Closer to your reference: smoother purple glass bar */
  background:
    radial-gradient(120% 180% at 18% 0%, rgba(255,77,255,.22) 0%, rgba(0,0,0,0) 58%),
    radial-gradient(120% 180% at 92% 12%, rgba(96,165,250,.14) 0%, rgba(0,0,0,0) 62%),
    linear-gradient(180deg, rgba(126,34,206,.62) 0%, rgba(76,29,149,.72) 42%, rgba(24,9,64,.90) 100%);
  box-shadow:
    0 18px 55px rgba(0,0,0,.62),
    0 0 0 1px rgba(168,85,247,.10) inset,
    0 0 40px rgba(168,85,247,.12);
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
}

/* v10.0.0: ambient glow anchor behind the nav */
.bottomnav.neonNav::before{
  content:"";
  position:absolute;
  inset:-18px -10px -26px -10px;
  border-radius:36px;
  background:
    radial-gradient(80% 140% at 50% 120%, rgba(255,77,255,.18), transparent 65%),
    radial-gradient(70% 140% at 20% 120%, rgba(96,165,250,.12), transparent 70%),
    radial-gradient(70% 140% at 80% 120%, rgba(168,85,247,.10), transparent 70%);
  filter: blur(10px);
  z-index:-1;
  pointer-events:none;
}

.tab.neonTab{
  color:rgba(255,255,255,.92);
  gap:6px;
  padding:10px 0;
}

.tab.neonTab .navIcon{
  /* Touch target wrapper (visual circle removed to match your reference) */
  width:44px;  /* iOS minimum */
  height:44px;
  display:grid;
  place-items:center;
}

.tab.neonTab .navIcon svg{
  width:24px;
  height:24px;
}

.tab.neonTab .label{
  font-size:13px;
  font-weight:700;
  letter-spacing:.25px;
  text-shadow: 0 0 10px rgba(0,0,0,.35);
  transition: transform .16s ease, opacity .16s ease;
}

/* v10.0.0: micro-animations */
.tab.neonTab .navIcon svg{
  transition: transform .16s ease, filter .16s ease, opacity .16s ease;
  opacity: .88;
}
.tab.neonTab.active .navIcon svg{
  opacity: 1;
  transform: translateY(-1px) scale(1.04);
  filter: drop-shadow(0 0 10px rgba(255,77,255,.55));
}
.tab.neonTab:active .navIcon svg{
  transform: translateY(0px) scale(0.98);
}
.tab.neonTab.active .label{ transform: translateY(1px); }

/* Per-tab accent used for underline + label emphasis (icons are multi-color via SVG gradients) */
/* v10.0.0: tighten color hierarchy
   - One PRIMARY neon drives interaction (underline + glow)
   - Icons can stay multi-color, but the selection language is consistent */
:root{ --primaryNeon:#ff4dff; }
.tab.neonTab{ --neon: var(--primaryNeon); }

/* Active state: stronger glow + subtle underline */
.tab.neonTab{ position:relative; }
.bottomnav.neonNav .tab.active::before{ display:none !important; } /* hard-disable legacy active box */
.tab.neonTab{ outline:none; }
.bottomnav.neonNav .tab:focus{ outline:none; }
.bottomnav.neonNav .tab:focus-visible{
  outline:2px solid rgba(255,255,255,.25);
  outline-offset:6px;
  border-radius:18px;
}
.tab.neonTab.active .navIcon{
  /* Glow is handled by SVG filters; keep wrapper clean */
}
.tab.neonTab.active .label{ color:#fff; }
.tab.neonTab.active::after{
  content:"";
  position:absolute;
  left:10px;
  right:10px;
  bottom:-4px;
  height:4px;
  border-radius:999px;
  background: color-mix(in srgb, var(--neon) 85%, #ffffff);
  filter: drop-shadow(0 0 10px color-mix(in srgb, var(--neon) 65%, transparent));
}

@media (max-width:420px){
  .bottomnav.neonNav{ padding:10px 10px 9px; border-radius:24px; }
  .tab.neonTab{ gap:4px; padding:8px 0; }
  .tab.neonTab .navIcon{ width:40px; height:40px; }
}

.tab{
  flex:1;
  border:none;
  background:transparent;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:0;
  padding:10px 0;
  cursor:pointer;
  color:rgba(255,255,255,.92);
  transition: transform .14s ease, filter .14s ease, opacity .14s ease;
}
.tab:active{transform:translateY(1px) scale(.985)}

/* v9.8.x: icons removed completely (kept as safety if any old markup remains) */
.tab .ico,
.tab .icoImg{display:none !important;}

.tab .label,
.tab span:last-child{
  font-size:16px;
  font-weight:800;
  letter-spacing:.2px;
  line-height:1;
}

/* Subtle active highlight behind label area (no icon box) */
.tab{position:relative}
.tab.active::before{
  content:"";
  position:absolute;
  inset:-6px 8px -6px 8px;
  border-radius:16px;
  background: rgba(255,255,255,.08);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.10);
  z-index:-1;
}

@media (max-width:780px){
  .tab .label,
  .tab span:last-child{font-size:14px;}
}

@media (max-width:420px){
  .bottomnav{
    width:calc(100% - 18px);
    padding:8px 8px 7px;
    bottom:calc(12px + env(safe-area-inset-bottom));
    border-radius:24px;
    gap:8px;
  }
  .tab{gap:0;padding:8px 0;}
  .tab .label,
  .tab span:last-child{font-size:12px;}
}

.modal{
  position:fixed;inset:0;
  display:flex;align-items:flex-end;justify-content:center;
  background:rgba(0,0,0,.25);
  padding:18px;
  z-index:30;
}
.modal.hidden{display:none}
.modalCard{
  width:min(720px, 100%);
  background:var(--card);
  border-radius:20px;
  box-shadow: var(--shadow);
  border:1px solid rgba(0,0,0,.08);
  overflow:hidden;
  max-height:85vh;
  display:flex;flex-direction:column;
}
.modalHead{display:flex;justify-content:space-between;align-items:center;padding:14px 14px 10px;border-bottom:1px solid rgba(0,0,0,.06)}
.modalTitle{font-weight:900}
.modalBody{padding:14px;overflow:auto}
.field{display:flex;flex-direction:column;gap:6px;margin:10px 0}
label{font-size:12px;color:var(--sub);font-weight:800}
input,select,textarea{
  padding:12px;border-radius:14px;border:1px solid rgba(0,0,0,.12);
  /* Default (light) controls: dark text on light bg. Night mode is overridden below. */
  background:rgba(255,255,255,.92);
  color:#0b1220;
  -webkit-text-fill-color:#0b1220;
  outline:none;
}
textarea{min-height:90px;resize:vertical}
.table{width:100%;border-collapse:separate;border-spacing:0 8px}
.tr{background:rgba(0,0,0,.03)}
.tr td{padding:10px 10px;border-top:1px solid rgba(0,0,0,.04);border-bottom:1px solid rgba(0,0,0,.04)}
.tr td:first-child{border-left:1px solid rgba(0,0,0,.04);border-top-left-radius:12px;border-bottom-left-radius:12px}
.tr td:last-child{border-right:1px solid rgba(0,0,0,.04);border-top-right-radius:12px;border-bottom-right-radius:12px;text-align:right}
.small{font-size:12px;color:var(--muted)}
.pill{display:inline-flex;gap:8px;align-items:center;padding:8px 10px;border-radius:999px;background:rgba(0,0,0,.04);font-weight:800}



.pageStack{display:flex;flex-direction:column;gap:16px}

.habitWrap{margin-top:10px;overflow:auto;-webkit-overflow-scrolling:touch}
.habitHeadRow,.habitRow{
  display:grid;
  grid-template-columns: minmax(160px, 1.2fr) repeat(7, 36px);
  gap:8px;
  align-items:center;
}
.habitHeadRow{padding:6px 6px 10px;border-bottom:1px solid rgba(15,23,42,.08);position:sticky;top:0;background:var(--card);z-index:1}
.habitRow{padding:10px 6px;border-bottom:1px solid rgba(15,23,42,.06)}
.habitRow:last-child{border-bottom:none}
.habitName{min-width:160px}
.habitNameInner{display:flex;align-items:center;gap:8px}
.habitIcon{font-size:18px}
.habitText{font-weight:600}
.habitDay{font-size:12px;color:var(--muted);text-align:center}
.habitBox{
  width:28px;height:28px;border-radius:999px;
  border:1px solid rgba(15,23,42,.16);
  background:rgba(15,23,42,.04);
  cursor:pointer;
  transition:transform .08s ease, box-shadow .12s ease, background .12s ease;
  margin:0 auto;
}
.habitBox.on{
  background:rgba(37,99,235,.18);
  border-color:rgba(37,99,235,.55);
  box-shadow:0 6px 14px rgba(37,99,235,.18);
}
.habitBox:active{transform:scale(.96)}
.habitStats{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
.statMini{background:rgba(15,23,42,.03);border:1px solid rgba(15,23,42,.06);border-radius:14px;padding:10px}
.statLabel{font-size:12px;color:var(--muted)}
.statValue{font-size:18px;font-weight:800;margin-top:4px}
@media (max-width:520px){
  .habitHeadRow,.habitRow{grid-template-columns:minmax(150px,1.2fr) repeat(7, 32px)}
  .habitBox{width:24px;height:24px}
}

/* v6.0 Habit Tracker squares + color */
.habitBox{
  width:28px;height:28px;
  border-radius:8px;
  border:2px solid rgba(15,23,42,.22);
  background: rgba(255,255,255,.22);
  box-shadow: 0 6px 14px rgba(0,0,0,.08);
  cursor:pointer;
}
.habitBox.on{
  background: var(--hc);
  border-color: var(--hc);
}
@media (prefers-color-scheme: dark){
  .habitBox{
    border-color: rgba(148,163,184,.45);
    background: rgba(148,163,184,.10);
  }
}
:root[data-theme="dark"] .habitBox{
  border-color: rgba(148,163,184,.45);
  background: rgba(148,163,184,.10);
}
:root[data-theme="light"] .habitBox{
  border-color: rgba(15,23,42,.22);
  background: rgba(255,255,255,.22);
}

/* v6.0 Habit header typography */
.habitTitle{
  font-size:16px;
  font-weight:900;
  letter-spacing:-0.01em;
}
.habitPeriod{
  font-size:12px;
  font-weight:700;
  color: var(--secondary);
}


/* ===== Balanced Life v6.1.4 (habits sizing + visibility) ===== */

/* Make Habit tracker card match other sections (Dashboard/Weekly) */
.habitSectionFix{ padding:16px; margin:12px 0; }

/* Improve +Навик button visibility in dark / night */
.habitAddBtn{ background: var(--accent) !important; color:#fff !important; border-color: transparent !important; }

/* Week selector pill */
.weekFilter{
  display:flex; align-items:center; gap:8px;
  padding:8px 10px;
  border-radius:999px;
  background: rgba(255,255,255,.10);
  border: 1px solid rgba(255,255,255,.14);
}
:root[data-sky="night"] .weekFilter{
  background: rgba(148,163,184,.10);
  border-color: rgba(148,163,184,.18);
}
.weekFilter select{
  padding:6px 10px;
  border-radius:12px;
}

/* Habit grid contrast */
.habitDay{ color: var(--muted); font-weight: 800; }
.habitBox{
  border-color: rgba(148,163,184,.55) !important;
  background: rgba(148,163,184,.12) !important;
}
:root[data-sky="day"] .habitBox,
:root[data-sky="sunrise"] .habitBox{
  border-color: rgba(15,23,42,.22) !important;
  background: rgba(255,255,255,.22) !important;
}
.habitBox.on{
  box-shadow: 0 10px 22px rgba(0,0,0,.18) !important;
}

/* ===== end v6.1.4 ===== */


/* ===== Deep Night Calm v6.1.5.1 =====
   Applies when :root[data-sky="night"] is active.
   No blur by default. Blur only on .featured cards.
*/

/* No blur by default */
.topbar{ backdrop-filter: none !important; -webkit-backdrop-filter: none !important; }
.bottomnav{ backdrop-filter: none !important; -webkit-backdrop-filter: none !important; }

/* Featured cards only */
.featured{
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}

/* Deep Night Calm palette */
:root[data-sky="night"]{
  --bg:#050814;
  --bgSolid:#050814;

  --card:#0B1C2D;
  --text:#eef2ff;
  --muted:#9aa7bf;
  --sub:#b7d8ff;
  --accent:#60a5fa;

  --shadow: 0 8px 24px rgba(0,0,0,0.35);
  --shadow2: 0 8px 24px rgba(0,0,0,0.35);

  --cardBorder: rgba(255,255,255,0.06);
  --cardDivider: rgba(255,255,255,0.04);

  /* Your gradient + subtle glow */
  --sky1: rgba(15,58,79,.08);  /* Accent glow 5–8% */
  --sky2: rgba(12,36,54,1);    /* Gradient Top */
  --sky3: rgba(5,8,20,1);      /* Gradient Bottom */
}

/* Make background use sky tokens (safe override) */
body{
  background:
    radial-gradient(1200px 700px at 15% 10%, var(--sky1), transparent 60%),
    radial-gradient(900px 700px at 85% 20%, var(--sky2), transparent 60%),
    radial-gradient(1000px 800px at 50% 95%, var(--sky3), transparent 60%),
    var(--bgSolid, var(--bg));
}

/* Use border/divider tokens where available */
.card{
  border: 1px solid var(--cardBorder, rgba(0,0,0,.06));
  box-shadow: var(--shadow);
}

/* ============================================================
   v10.0.0 — Final spacing + typography pass (global polish)
   - Slightly more breathing room
   - Cleaner hierarchy
   - Better readability against neon/space background
============================================================ */

.app{ padding:16px 16px 112px; }

.section{ padding:18px; margin:14px 0; }

.h1{
  font-size:20px;
  letter-spacing:-0.01em;
  line-height:1.2;
}

.sub{
  font-size:13px;
  letter-spacing:0.01em;
  opacity:0.92;
}

.card{
  border:1px solid rgba(255,255,255,.10);
}

.kpi{
  background: rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.08);
}

.kpi .v{ font-size:24px; letter-spacing:-0.01em; }

/* Better tap rhythm on small screens */
@media (max-width:420px){
  .app{ padding:14px 14px 106px; }
  .section{ padding:16px; }
  .h1{ font-size:18px; }
}
.modalCard{ border: 1px solid var(--cardBorder, rgba(0,0,0,.08)); }
.modalHead{ border-bottom: 1px solid var(--cardDivider, rgba(0,0,0,.06)); }

/* Night topbar/bottomnav without blur */
:root[data-sky="night"] .topbar{
  background: linear-gradient(180deg, rgba(5,8,20,.92), rgba(5,8,20,.65));
}
:root[data-sky="night"] .bottomnav{
  background: transparent;
  border: none;
}

/* Featured card surface */
.featured{
  background: rgba(11,28,45,.70);
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: 0 10px 28px rgba(0,0,0,0.42);
}

/* ===== end v6.1.5.1 ===== */


/* ===== Sky Day Premium v6.1.7 =====
   Cleaner blue sky + subtle sun glow.
   Featured blur ONLY in light mode.
*/

/* Sky Day refined palette */
:root[data-sky="day"]{
  --bg:#eef5ff;
  --bgSolid:#eef5ff;

  /* cleaner blue sky */
  --sky1: rgba(56,189,248,.22);   /* soft blue */
  --sky2: rgba(59,130,246,.18);   /* sky blue */
  --sky3: rgba(250,204,21,.16);   /* sun glow */

  --card:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --sub:#1e40af;

  --shadow: 0 12px 28px rgba(15,23,42,.12);
  --shadow2: 0 8px 20px rgba(15,23,42,.10);
}

/* Ensure no blur by default in light */
:root[data-sky="day"] .topbar,
:root[data-sky="day"] .bottomnav{
  backdrop-filter:none !important;
  -webkit-backdrop-filter:none !important;
}

/* Featured cards: very subtle blur in light */
:root[data-sky="day"] .featured{
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  background: rgba(255,255,255,.78);
  border: 1px solid rgba(15,23,42,.08);
  box-shadow: 0 14px 32px rgba(15,23,42,.16);
}

/* ===== end v6.1.7 ===== */


/* ===== v6.1.3 weekly tiles ===== */
.weekTiles{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px}
@media (min-width:980px){.weekTiles{grid-template-columns:repeat(4,1fr)}}
@media (max-width:740px){.weekTiles{grid-template-columns:1fr}}
.weekTile{
  text-align:left;width:100%;border:none;padding:14px;border-radius:18px;cursor:pointer;
  background: rgba(255,255,255,.10);
  border: 1px solid rgba(255,255,255,.16);
  box-shadow: var(--shadow2);
  color: var(--text);
}
:root[data-sky="night"] .weekTile{background: rgba(11,28,45,.80); border-color: rgba(255,255,255,0.08);}
.weekTileTop{display:flex;align-items:center;justify-content:space-between;gap:10px}
.weekTileTitle{font-size:14px;font-weight:900;letter-spacing:-0.01em}
.weekTileIcon{font-size:18px;opacity:.95}
.weekTileValue{margin-top:10px;font-size:22px;font-weight:950}
.weekTileSub{margin-top:4px;font-size:var(--fs-small);color:var(--muted);font-weight:700}


/* ===== v6.1.4 habits UI visibility ===== */
.habitTitle{font-size:var(--fs-title);font-weight:900;letter-spacing:-0.01em}
.habitPeriod{font-size:var(--fs-small);font-weight:800;color:var(--muted)}
.habitAddBtn{background:var(--accent)!important;color:#fff!important;border-color:transparent!important}
.weekFilter{
  display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;
  background: rgba(255,255,255,.10); border: 1px solid rgba(255,255,255,.14);
}
:root[data-sky="night"] .weekFilter{background: rgba(255,255,255,.06);border-color: rgba(255,255,255,.10);}
.weekFilter select{padding:6px 10px;border-radius:12px}


/* ===== v6.1.3 preset habit buttons ===== */
.presetGrid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}
@media (max-width:520px){.presetGrid{grid-template-columns:1fr}}
.presetBtn{
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:10px 12px;border-radius:16px;
  border:1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.10);
  box-shadow: var(--shadow2);
  cursor:pointer;
  color: var(--text);
}
:root[data-sky="night"] .presetBtn{background: rgba(11,28,45,.80);border-color: rgba(255,255,255,0.10);}
.presetLeft{display:flex;align-items:center;gap:10px}
.presetIcon{font-size:18px}
.presetName{font-weight:900}
.presetMeta{font-size:var(--fs-small);color:var(--muted);font-weight:700}
.presetAdd{font-weight:950;opacity:.9}


/* ===== v6.2.6 polish (energy ring + weekly tiles + week select readability) ===== */

/* Energy ring visibility in night */
:root[data-sky="night"] .kpiRing,
:root[data-sky="night"] .ring,
:root[data-sky="night"] svg circle{
  /* safe: only affects inside widget due to inline attrs being stronger; we override via classes below too */
}
:root[data-sky="night"] .energyWrap{
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
}
:root[data-sky="night"] .energyLabel{
  color: rgba(255,255,255,0.86);
}

/* Weekly tiles bigger */
.weekTile{
  padding:18px !important;
  border-radius:20px !important;
}
.weekTileTitle{ font-size: 15px !important; }
.weekTileValue{ font-size: 28px !important; }
.weekTileSub{ font-size: 12px !important; line-height:1.25; }

/* Week selector readability */
.weekFilter{
  background: rgba(255,255,255,.12) !important;
  border-color: rgba(255,255,255,.18) !important;
}
.weekFilter select{
  background: rgba(255,255,255,.16) !important;
  border: 1px solid rgba(255,255,255,.18) !important;
  color: var(--text) !important;
}
:root[data-sky="night"] .weekFilter select{
  background: rgba(255,255,255,.06) !important;
  border-color: rgba(255,255,255,.14) !important;
  color: rgba(255,255,255,.92) !important;
}

/* Habit tracker range typography: make digits match */
.habitRange{
  font-size: 14px;
  font-weight: 900;
  letter-spacing:-0.01em;
  color: var(--text);
}
.habitRange .mutedInline{
  color: var(--muted);
  font-weight: 800;
}
/* ===== end v6.2.6 ===== */


/* ===== v6.2.9 Dashboard donuts ===== */
.donutRow{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:14px}
@media (max-width:820px){.donutRow{grid-template-columns:1fr;gap:12px}}
.donutCard{display:flex;align-items:center;justify-content:center;padding:14px;border-radius:20px;border:1px solid rgba(255,255,255,0.10);background: rgba(255,255,255,0.06);box-shadow: var(--shadow2);}
:root[data-sky="day"] .donutCard{background: rgba(255,255,255,.60); border-color: rgba(15,23,42,0.08);}
:root[data-sky="night"] .donutCard{background: rgba(11,28,45,.60); border-color: rgba(255,255,255,0.10);}
.donut{width:150px;height:150px; position:relative; display:grid; place-items:center;}
.donut svg{width:150px;height:150px; transform: rotate(-90deg);}
.donut .center{position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center;}
.donut .center .t{font-size:12px;font-weight:900;color:var(--muted);letter-spacing:-0.01em}
.donut .center .v{font-size:34px;font-weight:950;line-height:1;color:var(--text)}
.donut .center .s{font-size:12px;font-weight:800;color:var(--muted);margin-top:2px}
.donutTrack{stroke: rgba(148,163,184,.18);}
:root[data-sky="night"] .donutTrack{stroke: rgba(255,255,255,.10);}
.donutArc{stroke-linecap:round; filter: drop-shadow(0px 8px 16px rgba(0,0,0,0.25));}
/* ===== end v6.2.9 ===== */


/* ===== v6.3.0 Glass background (like reference) ===== */
body{
  /* warm bokeh-ish background without images */
  background:
    radial-gradient(1200px 700px at 10% 15%, rgba(255,190,120,0.55), rgba(255,190,120,0.0) 60%),
    radial-gradient(900px 520px at 80% 20%, rgba(255,120,90,0.35), rgba(255,120,90,0.0) 58%),
    radial-gradient(900px 650px at 65% 80%, rgba(120,190,255,0.30), rgba(120,190,255,0.0) 60%),
    radial-gradient(1000px 700px at 20% 85%, rgba(200,160,255,0.24), rgba(200,160,255,0.0) 62%),
    linear-gradient(180deg, #050814 0%, #071321 45%, #050814 100%);
  background-attachment: fixed;
}
/* keep themes but give "glass" top overlay */
:root[data-theme="light"] body{
  background:
    radial-gradient(1100px 680px at 15% 15%, rgba(255,210,150,0.65), rgba(255,210,150,0.0) 60%),
    radial-gradient(900px 520px at 80% 22%, rgba(255,150,120,0.40), rgba(255,150,120,0.0) 58%),
    radial-gradient(900px 650px at 70% 78%, rgba(130,200,255,0.38), rgba(130,200,255,0.0) 60%),
    radial-gradient(1000px 700px at 25% 85%, rgba(210,190,255,0.30), rgba(210,190,255,0.0) 62%),
    linear-gradient(180deg, #EAF2FF 0%, #F7FAFF 60%, #EAF2FF 100%);
}

/* Glass shell: blur only on main wrapper like reference */
.wrap{
  background: rgba(8, 16, 28, 0.28);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 26px;
  box-shadow: 0px 18px 60px rgba(0,0,0,0.35);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
}
:root[data-theme="light"] .wrap{
  background: rgba(255,255,255,0.58);
  border-color: rgba(15,23,42,0.10);
  box-shadow: 0px 18px 60px rgba(2, 6, 23, 0.14);
}

/* make cards a bit more glassy to match reference */
.card{
  background: rgba(11,28,45,0.55);
  border-color: rgba(255,255,255,0.10);
}
:root[data-theme="light"] .card{
  background: rgba(255,255,255,0.65);
  border-color: rgba(15,23,42,0.08);
}

/* ===== end v6.3.0 ===== */


/* ===== v6.3.1 Dashboard radial fixes ===== */
.donut{width:220px;height:220px}
.donut svg{width:220px;height:220px; transform:none !important;} /* text upright */
@media (max-width:820px){
  .donut{width:200px;height:200px}
  .donut svg{width:200px;height:200px}
}
/* make the 3 rings feel like "graphics" not tiles */
.donutCard{background: transparent; border-color: rgba(255,255,255,0.10);}
:root[data-theme="light"] .donutCard{background: rgba(255,255,255,0.25);}
/* ===== end v6.3.1 ===== */


/* ===== v6.3.2 Habit tracker + dashboard fixes ===== */
.habitTitle{font-size:22px;font-weight:900;letter-spacing:-0.02em;color:var(--text)}
.habitRange{font-size:13px;font-weight:800;color:var(--muted)}
/* make habit boxes visible + fill on check */
.habitBox{
  width:28px;height:28px;border-radius:8px;
  border:1px solid rgba(255,255,255,0.16);
  background:rgba(255,255,255,0.06);
}
:root[data-theme="light"] .habitBox{
  border:1px solid rgba(15,23,42,0.16);
  background:rgba(15,23,42,0.04);
}
.habitBox.on{
  background:rgba(37,99,235,0.55);
  border-color:rgba(96,165,250,0.85);
  box-shadow:0 10px 18px rgba(37,99,235,0.25);
}
/* ===== end v6.3.2 ===== */


/* ===== v6.3.3 language switch ===== */
.topActions{display:flex;gap:10px;align-items:center}
.langSwitch{display:flex;gap:6px;align-items:center}
.langBtn{min-width:44px}
.langBtn.isActive{
  box-shadow: 0 0 0 2px rgba(255,255,255,0.18) inset, 0px 10px 24px rgba(0,0,0,0.25);
}
:root[data-theme="light"] .langBtn.isActive{
  box-shadow: 0 0 0 2px rgba(15,23,42,0.12) inset, 0px 10px 24px rgba(2,6,23,0.12);
}
/* ===== end v6.3.3 ===== */


/* ===== v6.9.2 Language toggle (active lang only) ===== */
.langToggle{
  position:relative;
  width:44px;
  height:44px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,0.16);
  background: rgba(255,255,255,0.10);
  box-shadow: 0 0 0 2px rgba(255,255,255,0.08) inset, 0px 10px 24px rgba(0,0,0,0.22);
  padding:0;
  display:grid;
  place-items:center;
}

.langToggle:focus-visible{outline:2px solid rgba(96,165,250,0.65); outline-offset:3px;}

.langToggle .langText{
  font-size:13px;
  font-weight:950;
  letter-spacing:0.06em;
  color: rgba(255,255,255,0.92);
  user-select:none;
}

/* Active state = BG (warm fill) */
.langToggle.isBG{
  background: linear-gradient(135deg, rgba(251,146,60,0.95), rgba(239,68,68,0.88));
  border-color: rgba(255,255,255,0.18);
}

/* ===== end v6.9.2 ===== */


/* ===== v6.3.4 Mobile layout + habit box contrast ===== */
.app{box-sizing:border-box;width:100%;}
*{box-sizing:border-box;}

body{overflow-x:hidden;}

@media (max-width:640px){
  .app{max-width:100%;width:100%;margin:0 auto;padding:12px 12px 96px;}
  .pageStack{gap:14px;}
  .card.section{padding:16px;}
  .donutRow{grid-template-columns:1fr; justify-items:center;}
  .donutCard{width:100%; display:flex; justify-content:center;}
}

/* Habit tracker: make boxes visible in dark + stronger "on" */
:root[data-theme="dark"] .habitBox{
  border:1px solid rgba(255,255,255,0.16);
  background:rgba(255,255,255,0.05);
}
:root[data-theme="dark"] .habitBox.on{
  background:rgba(96,165,250,0.65);
  border-color:rgba(147,197,253,0.95);
  box-shadow:0 10px 22px rgba(96,165,250,0.30);
}
:root[data-theme="light"] .habitBox.on{
  background:rgba(37,99,235,0.30);
  border-color:rgba(37,99,235,0.75);
  box-shadow:0 10px 22px rgba(37,99,235,0.20);
}

/* Ensure checked squares are always visible (use habit color) */
.habitBox.on{background:var(--hc, rgba(96,165,250,0.65)) !important; border-color:var(--hc, rgba(147,197,253,0.95)) !important;}
.habitBox.on::after{content:"✓"; display:block; color:white; font-weight:900; font-size:14px; line-height:1;}
.habitBox{display:grid; place-items:center;}

/* Dashboard donut meta + quick actions */
.donutStack{display:flex; flex-direction:column; align-items:center; gap:8px; width:100%;}
.donutMeta{font-size:12px; font-weight:800; color:var(--muted); text-align:center; line-height:1.25;}
.dashActions{display:flex; gap:10px; margin-top:14px; flex-wrap:wrap;}
.dashActions .btn{padding:10px 12px; border-radius:14px;}

@media (max-width:640px){
  .dashActions{gap:8px;}
  .dashActions .btn{flex:1 1 auto; min-width:120px; justify-content:center;}
}
/* ===== end v6.3.4 ===== */

/* ===== v6.3.8 Add button pill + Habit mobile spacing ===== */
.btn.addPill{padding:0;border:0;background:transparent;box-shadow:none}
.addPillInner{display:flex;align-items:center;gap:12px;border-radius:999px;padding:10px 10px 10px 18px;background:linear-gradient(90deg, rgba(251,146,60,0.95), rgba(239,68,68,0.88));box-shadow:0px 10px 26px rgba(0,0,0,0.22)}
:root[data-theme="light"] .addPillInner{box-shadow:0px 10px 26px rgba(2,6,23,0.12)}
.addPillText{font-weight:900;font-size:13px;color:#fff;letter-spacing:-0.01em}
.addPillPlus{width:38px;height:38px;border-radius:999px;background:rgba(255,255,255,0.88);display:grid;place-items:center;color:rgba(15,23,42,0.85);font-weight:950;font-size:22px;line-height:1}
.btn.addPill:active .addPillInner{transform:translateY(1px)}
.btn.addPill.smallAdd .addPillInner{padding:8px 8px 8px 14px}
.btn.addPill.smallAdd .addPillPlus{width:32px;height:32px;font-size:20px}

/* Habit tracker mobile: prevent "squeezed" grid */
@media (max-width:640px){
  /* v6.9.2: show the full habit week without horizontal scrolling */
  .habitWrap{overflow-x:hidden;padding-bottom:6px}
  .habitHeadRow,.habitRow{min-width:0; grid-template-columns:minmax(120px,1fr) repeat(7, 1fr)}
  .habitBox{width:100%; aspect-ratio:1 / 1; height:auto; max-width:34px; justify-self:center}
  .habitTitle{font-size:22px}
  .habitRange{font-size:12px}
  .habitSectionFix .cardHead{flex-direction:column;align-items:stretch;gap:12px}
  .habitSectionFix .cardHead>div:last-child{justify-content:space-between}
  .weekFilter{flex:1 1 auto}
}
/* ===== end v6.3.8 ===== */

/* ===== v6.3.5 Mobile overflow + habit mark visibility ===== */
html,body{overflow-x:hidden;}

@media (max-width:640px){
  .topbar{flex-wrap:wrap; gap:10px;}
  .brand{min-width:0;}
  .brandTitle{max-width:60vw; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
  .topActions{flex-wrap:wrap; justify-content:flex-end;}
  .card{max-width:100%;}
}

.habitBox.on{
  background: var(--hc, rgba(37,99,235,0.85)) !important;
  border-color: rgba(255,255,255,0.65) !important;
  box-shadow: 0 10px 22px rgba(0,0,0,0.18), 0 10px 22px color-mix(in srgb, var(--hc, #3b82f6) 35%, transparent);
}
.habitBox.on::after{
  content: "✓";
  display:block;
  width:100%; height:100%;
  color: rgba(255,255,255,0.95);
  font-weight: 900;
  font-size: 14px;
  line-height: 26px;
  text-align:center;
}
:root[data-theme="light"] .habitBox.on::after{color: rgba(15,23,42,0.92);}
/* ===== end v6.3.5 ===== */


/* ===== v6.3.5 Habit on-state + mobile overflow fix ===== */
body{overflow-x:hidden;}
.topbar{flex-wrap:wrap;gap:10px}
.brand{min-width:0}
.topActions{flex-wrap:wrap;justify-content:flex-end}

.habitBox{position:relative}
.habitBox.on{
  background: var(--hc, #2563eb) !important;
  border-color: var(--hc, #2563eb) !important;
  box-shadow: 0 10px 20px rgba(37,99,235,0.22) !important;
}
.habitBox.on::after{
  content:"✓";
  position:absolute; inset:0;
  display:grid; place-items:center;
  color:white;
  font-size:14px;
  font-weight:900;
}

@media (max-width:640px){
  .card{max-width:100%}
  .donutCard{max-width:100%}
}
/* ===== end v6.3.5 ===== */







/* ===== v6.3.5 Habit box on-state + mobile overflow fix ===== */
body{overflow-x:hidden}
.topbar{flex-wrap:wrap;row-gap:10px}
.topActions{flex-wrap:wrap;justify-content:flex-end}
.brand{min-width:0}
.brandTitle{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:220px}

.habitBox.on{
  background: var(--hc, rgba(37,99,235,0.70)) !important;
  border-color: var(--hc, rgba(96,165,250,0.95)) !important;
  box-shadow: 0 10px 22px rgba(0,0,0,0.18), 0 10px 22px rgba(96,165,250,0.22);
}
.habitBox.on::after{
  content: "✓";
  display:grid;
  place-items:center;
  width:100%;
  height:100%;
  color: rgba(255,255,255,0.95);
  font-size: 16px;
  font-weight: 900;
  text-shadow: 0 6px 14px rgba(0,0,0,0.25);
}
:root[data-theme="light"] .habitBox.on::after{color: rgba(15,23,42,0.90)}

@media (max-width:640px){
  .card{max-width:100%}
  .view{padding:8px 0}
}
/* ===== end v6.3.5 ===== */



/* ===== v6.3.7 Preset habits ===== */
.presetGrid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px}
@media (max-width:820px){.presetGrid{grid-template-columns:repeat(3,1fr)}}
@media (max-width:420px){.presetGrid{grid-template-columns:repeat(2,1fr)}}
.presetBtn{display:flex;align-items:center;gap:8px;justify-content:flex-start;padding:10px 10px;border-radius:14px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.06);cursor:pointer}
:root[data-theme="light"] .presetBtn{border-color:rgba(15,23,42,0.10);background:rgba(255,255,255,0.65)}
.presetBtn:hover{transform:translateY(-1px)}
.presetEmoji{font-size:18px}
.presetName{font-size:12px;font-weight:900;line-height:1.1}
.presetTag{font-size:11px;color:var(--muted);font-weight:700;margin-top:2px}
/* ===== end v6.3.7 ===== */

/* ===== v6.3.9 Interactions: chart shortcuts + tap bounce + habit fill animation ===== */

/* Donut cards are now buttons (shortcuts) */
.donutCardLink{border:none;cursor:pointer;text-align:left;}
.donutCardLink:focus-visible{outline:2px solid rgba(96,165,250,0.65);outline-offset:3px;}

.tapBounce{animation:tapBounce 220ms ease-out;}
@keyframes tapBounce{
  0%{transform:scale(1)}
  45%{transform:scale(0.97)}
  100%{transform:scale(1)}
}

/* Habit tracker: fill animation instead of static look */
.habitBox{position:relative;overflow:hidden;}
.habitBox::before{
  content:"";
  position:absolute;
  inset:0;
  background:var(--hc, #60a5fa);
  opacity:0.85;
  transform:scale(0);
  border-radius:10px;
  transition:transform 180ms ease-out, opacity 180ms ease-out;
}
.habitBox.on::before{transform:scale(1);}
.habitBox::after{
  content:"✓";
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  color:rgba(255,255,255,0.95);
  text-shadow:0 6px 14px rgba(0,0,0,0.35);
  opacity:0;
  transform:scale(0.6);
  transition:opacity 160ms ease-out, transform 160ms ease-out;
}
.habitBox.on::after{opacity:1;transform:scale(1);}

.habitBox.pulse.on::before{animation:hbFillPop 220ms ease-out;}
.habitBox.pulse.on::after{animation:hbCheckPop 220ms ease-out;}
@keyframes hbFillPop{
  0%{transform:scale(0)}
  70%{transform:scale(1.06)}
  100%{transform:scale(1)}
}
@keyframes hbCheckPop{
  0%{opacity:0;transform:scale(0.6)}
  70%{opacity:1;transform:scale(1.1)}
  100%{opacity:1;transform:scale(1)}
}

/* ===== end v6.3.9 ===== */


/* ===== v6.4.1 Habits page + comfy week + responsive home habits ===== */
.homeHabitsLink{display:none; cursor:pointer;}
.homeHabitsInline{display:block;}
@media (max-width:640px){
  .homeHabitsInline{display:none;}
  .homeHabitsLink{display:block;}
}

.weekComfy{position:relative; display:flex; align-items:center; gap:10px; padding:10px 14px; border-radius:999px;
  background:linear-gradient(135deg, rgba(255,255,255,0.10), rgba(255,255,255,0.04));
  border:1px solid rgba(255,255,255,0.12);
  box-shadow:0 10px 22px rgba(0,0,0,0.18);
  min-width:180px;
}
:root[data-theme="light"] .weekComfy{background:linear-gradient(135deg, rgba(255,255,255,0.75), rgba(255,255,255,0.35)); border:1px solid rgba(0,0,0,0.06);}
.weekComfyLabel{font-weight:900; font-size:12px; opacity:0.85;}
.weekComfyPill{display:flex; align-items:center; justify-content:space-between; gap:10px; width:100%; padding:10px 14px; border-radius:999px;
  background:linear-gradient(90deg, rgba(255,167,90,0.95), rgba(255,111,0,0.95));
  box-shadow:inset 0 1px 0 rgba(255,255,255,0.28), 0 12px 26px rgba(0,0,0,0.28);
  color:#fff;
}
.weekComfyCaret{font-weight:900; opacity:0.9;}
:root[data-theme="light"] .weekComfyPill{box-shadow:inset 0 1px 0 rgba(255,255,255,0.55), 0 10px 22px rgba(0,0,0,0.12);}

.weekComfyValue{font-weight:900; font-size:13px;}
.weekComfySelect{position:absolute; inset:0; opacity:0; cursor:pointer;}

@media (max-width:520px){
  .weekComfy{width:100%; min-width:0;}
  .weekComfyPill{width:100%;}
  .weekComfyValue{font-size:12px; line-height:1.15; white-space:normal;}
}

.insightRow{margin-top:10px; padding:10px 12px; border-radius:14px; background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.06); font-weight:800; color:var(--text);}
:root[data-theme="light"] .insightRow{background:rgba(0,0,0,0.03); border:1px solid rgba(0,0,0,0.06);}
/* ===== end v6.4.1 ===== */



/* v6.4.3 chevron */
.chev{font-size:28px;line-height:1;font-weight:900;opacity:.6;}
:root[data-theme="light"] .chev{opacity:.45;}


/* ===== v6.4.3 habits mobile grid ===== */
@media (max-width:420px){
  .habitHeadRow,.habitRow{
    grid-template-columns: minmax(116px, 1fr) repeat(7, 28px);
    gap:6px;
  }
  .habitName{min-width:116px}
  .habitIcon{font-size:16px}
  .habitBox{width:28px;height:28px;border-radius:7px}
}
/* ===== end v6.4.3 ===== */


/* v6.4.4 header settings button */
.iconbtn{width:40px;height:40px;border-radius:14px;border:1px solid rgba(255,255,255,.22);background:rgba(255,255,255,.14);backdrop-filter:blur(10px);box-shadow:var(--shadow);display:grid;place-items:center;font-size:18px;color:var(--text);cursor:pointer}
:root[data-theme="light"] .iconbtn{border:1px solid rgba(0,0,0,.08);background:rgba(255,255,255,.72)}


/* ===== v6.4.4 habits fit 7 days ===== */
@media (max-width:420px){
  .habitHeadRow,.habitRow{
    grid-template-columns: minmax(92px, 1fr) repeat(7, 22px);
    gap:4px;
  }
  .habitDay{font-size:11px;opacity:.9}
  .habitIcon{font-size:15px}
  .habitTitleCell{font-size:13px}
  .habitName{max-width:92px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .habitBox{width:22px;height:22px;border-radius:6px}
}
@media (max-width:360px){
  .habitHeadRow,.habitRow{
    grid-template-columns: minmax(86px, 1fr) repeat(7, 20px);
    gap:4px;
  }
  .habitBox{width:20px;height:20px;border-radius:6px}
  .habitName{max-width:86px}
}
/* ===== end v6.4.4 ===== */

/* ===== Finances UI v6.6.0 (visual refresh) ===== */
.finHero{position:relative;overflow:hidden}
.finHero::before{content:"";position:absolute;inset:-2px;background:radial-gradient(1200px 420px at 20% 0%, rgba(99,102,241,.28), transparent 60%),radial-gradient(900px 380px at 90% 10%, rgba(251,146,60,.22), transparent 55%),radial-gradient(900px 500px at 55% 120%, rgba(34,197,94,.18), transparent 60%);pointer-events:none}
.finHero > *{position:relative}

.finGlass{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.10);backdrop-filter: blur(16px);box-shadow: 0 22px 60px rgba(0,0,0,0.20)}

.finHeroHead{display:flex;justify-content:space-between;align-items:flex-start;gap:14px;flex-wrap:wrap}

/* Finances: Entry button (pill only, no extra square) */
.finEntryBtn{border:0;background:transparent;box-shadow:none}
.finEntryBtn .addPillInner{box-shadow:0px 10px 22px rgba(0,0,0,0.22)}
.finEntryBtn:hover .addPillInner{transform: translateY(-1px)}
.finEntryBtn:active .addPillInner{transform: translateY(1px)}

.finStats{display:grid;grid-template-columns:1fr auto 1fr;gap:14px;align-items:stretch;margin-top:14px}

/* Scale down Income / Balance / Expenses on smaller screens */
@media (max-width: 420px){
  .finStats{gap:10px}
  .finStatCard{padding:10px 12px;border-radius:16px}
  .finStatLabel{font-size:12px}
  .finStatValue{font-size:18px}
  .finStatDelta{font-size:12px}
  .finBalancePill{min-width:160px;padding:10px 12px}
  .finBalanceLabel{font-size:12px}
  .finBalanceValue{font-size:18px}
  .finPager span{width:6px;height:6px}
}

/* Even tighter stats on small phones */
@media (max-width: 390px){
  .finStats{gap:8px}
  .finStatCard{padding:8px 10px;border-radius:14px}
  .finStatLabel{font-size:11px}
  .finStatValue{font-size:16px}
  .finStatDelta{font-size:11px}
  .finBalancePill{min-width:132px;padding:8px 10px}
  .finBalanceLabel{font-size:11px}
  .finBalanceValue{font-size:16px}
}

.finStatCard{padding:14px 16px;border-radius:20px;border:1px solid rgba(255,255,255,0.10);background:rgba(255,255,255,0.06);backdrop-filter: blur(16px);box-shadow: 0 20px 50px rgba(0,0,0,0.18)}
.finStatCard.positive{background:linear-gradient(135deg, rgba(52,211,153,0.10), rgba(255,255,255,0.05));border-color: rgba(52,211,153,0.18)}
.finStatCard.negative{background:linear-gradient(135deg, rgba(251,146,60,0.12), rgba(255,255,255,0.05));border-color: rgba(251,146,60,0.18)}
.finStatLabel{font-size:13px;font-weight:850;color:rgba(255,255,255,0.72)}
.finStatRow{display:flex;justify-content:space-between;align-items:baseline;gap:12px;margin-top:10px}
.finStatValue{font-size:22px;font-weight:950;letter-spacing:.2px;color:rgba(255,255,255,0.92)}
.finStatDelta{font-size:13px;font-weight:900;color:rgba(255,255,255,0.62)}

.finBalancePill{display:grid;place-items:center;padding:14px 18px;min-width:220px;border-radius:999px;border:1px solid rgba(255,255,255,0.10);background:rgba(0,0,0,0.18);backdrop-filter: blur(16px);box-shadow: 0 24px 60px rgba(0,0,0,0.22)}
.finBalanceLabel{font-size:13px;font-weight:850;color:rgba(255,255,255,0.65)}
.finBalanceValue{font-size:22px;font-weight:950;color:rgba(255,255,255,0.92);margin-top:4px}
.finPager{display:flex;gap:6px;margin-top:10px}
.finPager span{width:7px;height:7px;border-radius:999px;background:rgba(255,255,255,0.16)}
.finPager span.on{background:rgba(255,255,255,0.55)}

.finChart{margin-top:16px;border-radius:20px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);overflow:hidden;padding:12px 12px 10px}
.finSvg{width:100%;height:auto;display:block}
.finLegend{display:flex;gap:14px;justify-content:center;align-items:center;margin-top:10px;font-size:12px;color:rgba(255,255,255,0.70);font-weight:850}
.finLegendItem{display:inline-flex;align-items:center;gap:8px}
.finDot{width:10px;height:10px;border-radius:999px;box-shadow:0 0 0 4px rgba(255,255,255,0.05)}
.finDot.inc{background:rgba(52,211,153,1)}
.finDot.exp{background:rgba(251,146,60,1)}

.finSectionHead{display:flex;justify-content:space-between;align-items:flex-end;gap:12px;flex-wrap:wrap}
.finSearch{min-width:min(340px,100%)}
.finSearchInput{width:100%;padding:12px 14px;border-radius:16px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.06);color:var(--text);outline:none;transition:border-color .18s ease, transform .18s ease}
.finSearchInput:focus{border-color:rgba(167,139,250,.45);transform: translateY(-1px)}

.finGoalsGrid2{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:14px;margin-top:14px}
.finGoalCard2{padding:14px;border-radius:20px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.10);box-shadow: 0 20px 60px rgba(0,0,0,0.18)}
.finGoalHeader2{display:flex;align-items:center;gap:12px}
.finGoalInfo2{flex:1;min-width:0}
.finGoalName2{font-weight:950;font-size:16px;color:rgba(255,255,255,0.92);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.finGoalMeta2{margin-top:4px;font-size:12px;color:rgba(255,255,255,0.62);font-weight:850}

.finBubble{width:54px;height:54px;border-radius:999px;background:rgba(0,0,0,0.22);border:1px solid rgba(255,255,255,0.10);display:grid;place-items:center;overflow:hidden;flex:0 0 auto}
.finBubble img{width:56px;height:56px;object-fit:cover;transform: scale(1.06)}

.finChip{display:inline-flex;align-items:center;justify-content:center;padding:4px 8px;border-radius:999px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.06);font-weight:950;letter-spacing:.3px;font-size:10px}
.finChip.auto{border-color: rgba(96,165,250,.30);background:rgba(96,165,250,.12)}
.finChip.manual{border-color: rgba(167,139,250,.30);background:rgba(167,139,250,.12)}

.finIconBtn{width:40px;height:40px;border-radius:14px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06);color:rgba(255,255,255,.85);cursor:pointer}
.finIconBtn:hover{transform: translateY(-1px);border-color: rgba(255,255,255,.18)}

.finGoalNumbers2{display:flex;align-items:baseline;gap:10px;margin-top:12px}
.finGoalNow2{font-size:22px;font-weight:950;color:rgba(255,255,255,0.92)}
.finGoalOf2{font-size:12px;font-weight:900;color:rgba(255,255,255,0.64)}

.finBar2{margin-top:12px;height:12px;border-radius:999px;background:rgba(0,0,0,0.22);border:1px solid rgba(255,255,255,0.08);overflow:hidden}
.finBarFill2{height:100%;border-radius:999px;box-shadow: 0 10px 26px rgba(0,0,0,0.18);transition: width .55s cubic-bezier(.2,.9,.2,1)}
.finBarFill2.track{background:linear-gradient(90deg, rgba(96,165,250,1), rgba(167,139,250,1))}
.finBarFill2.ahead{background:linear-gradient(90deg, rgba(52,211,153,1), rgba(34,197,94,1))}
.finBarFill2.behind{background:linear-gradient(90deg, rgba(251,146,60,1), rgba(239,68,68,1))}

.finGoalBottom2{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-top:10px}
.finGoalLeft2{font-size:12px;color:rgba(255,255,255,0.72);font-weight:850}
.finGoalStatus2{font-size:12px;font-weight:950;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.10);background:rgba(255,255,255,0.06)}
.finGoalStatus2.ahead{border-color: rgba(52,211,153,.25);background:rgba(52,211,153,.10)}
.finGoalStatus2.behind{border-color: rgba(239,68,68,.25);background:rgba(239,68,68,.10)}

.finGoalActions2{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}

.finEntriesGrid{margin-top:14px;display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
.finEntryCard{display:flex;gap:12px;align-items:center;padding:12px 14px;border-radius:20px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.10);transition: transform .18s ease, border-color .18s ease}
.finEntryCard:hover{transform: translateY(-1px);border-color: rgba(255,255,255,0.16)}
.finEntryMain{flex:1;min-width:0}
.finEntryTop{display:flex;justify-content:space-between;gap:10px;align-items:baseline}
.finEntryTitle{font-weight:950;color:rgba(255,255,255,0.92);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.finEntryAmount{font-weight:950;white-space:nowrap}
.finEntryAmount.inc{color:rgba(52,211,153,1)}
.finEntryAmount.exp{color:rgba(251,146,60,1)}
.finEntrySub{display:flex;gap:10px;align-items:center;margin-top:6px}
.finEntryTag{font-size:10px;font-weight:950;letter-spacing:.3px;text-transform:uppercase;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.10);background:rgba(255,255,255,0.06)}
.finEntryTag.inc{border-color: rgba(52,211,153,.25);background:rgba(52,211,153,.10)}
.finEntryTag.exp{border-color: rgba(251,146,60,.25);background:rgba(251,146,60,.10)}
.finEntryDate{font-size:12px;color:rgba(255,255,255,0.60);font-weight:850}
.finEntryDel{width:34px;height:34px;border-radius:12px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.06);color:rgba(255,255,255,0.85);cursor:pointer}
.finEntryDel:hover{border-color: rgba(255,255,255,0.18);transform: translateY(-1px)}

.finEmpty{padding:18px;border-radius:18px;background:rgba(0,0,0,0.14);border:1px dashed rgba(255,255,255,0.18)}
.finEmptyTitle{font-weight:950;color:rgba(255,255,255,0.90);margin-bottom:6px}

@media (max-width: 860px){
  .finStats{grid-template-columns:1fr;}
  .finBalancePill{min-width:unset;border-radius:20px;place-items:start;align-items:start}
  .finEntriesGrid{grid-template-columns:1fr;}
  .finGoalsGrid2{grid-template-columns:1fr;}
}
/* ===== end finances ===== */

/* Light theme tuning (finances) */
:root[data-theme="light"] .finGlass,
:root[data-theme="light"] .finStatCard,
:root[data-theme="light"] .finBalancePill,
:root[data-theme="light"] .finChart,
:root[data-theme="light"] .finGoalCard2,
:root[data-theme="light"] .finEntryCard,
:root[data-theme="light"] .finSearchInput{background:rgba(255,255,255,0.70);border-color: rgba(15,23,42,0.12)}
:root[data-theme="light"] .finHero::before{opacity:.55}
:root[data-theme="light"] .finStatLabel,
:root[data-theme="light"] .finStatDelta,
:root[data-theme="light"] .finBalanceLabel,
:root[data-theme="light"] .finEntryDate,
:root[data-theme="light"] .finGoalMeta2,
:root[data-theme="light"] .finGoalOf2{color: rgba(15,23,42,0.60)}
:root[data-theme="light"] .finStatValue,
:root[data-theme="light"] .finBalanceValue,
:root[data-theme="light"] .finGoalName2,
:root[data-theme="light"] .finGoalNow2,
:root[data-theme="light"] .finEntryTitle{color: rgba(15,23,42,0.92)}
:root[data-theme="light"] .finDot{box-shadow:0 0 0 4px rgba(15,23,42,0.06)}
:root[data-theme="light"] .finEmpty{background:rgba(255,255,255,0.75);border-color: rgba(15,23,42,0.14)}
:root[data-theme="light"] .finEmptyTitle{color: rgba(15,23,42,0.90)}


/* ===== v6.6.2 visual polish ===== */

/* Entry button */
.entry-btn {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 12px 20px;
  border-radius: 999px;
  background: linear-gradient(135deg,#ff8a5c,#ff5f6d);
  color:#fff;
  font-weight:600;
  border:none;
}
.entry-btn span.plus {
  display:inline-flex;
  width:26px;
  height:26px;
  border-radius:50%;
  background:rgba(255,255,255,0.25);
  align-items:center;
  justify-content:center;
  font-size:18px;
}

/* Chart glow */
.chart-line-income {
  stroke:#7CFFB2;
  filter: drop-shadow(0 0 6px rgba(124,255,178,.6));
}
.chart-line-expense {
  stroke:#FF8A8A;
  filter: drop-shadow(0 0 6px rgba(255,138,138,.6));
}
.chart-dot {
  fill:#fff;
  stroke-width:3;
}

/* Goals cards spacing */
.goal-card {
  padding:22px;
  border-radius:18px;
}
.goal-progress {
  height:8px;
  border-radius:6px;
}

/* Recent entries grid */
.recent-grid {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
.recent-item {
  padding:16px;
  border-radius:16px;
}


/* ===== v6.9.0: Animated chart + Entry modal + Category bubbles ===== */

.finEntriesGrid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:14px;
}

@media (max-width: 820px){
  .finEntriesGrid{ grid-template-columns: 1fr; }
}

.finEntryRow{
  position:relative;
  overflow:hidden;
}

.finEntryIcon{
  width:52px;
  height:52px;
  border-radius:50%;
  background: rgba(255,255,255,0.06);
  display:flex;
  align-items:center;
  justify-content:center;
  flex: 0 0 auto;
}

.finEntryIcon img{
  width:46px;
  height:46px;
  /* The PNG itself is the square (rounded corners, glow). Fill the slot 1:1. */
  object-fit:cover;
  border-radius:50%;
}

.finEntryCat{
  opacity:.85;
  text-transform:capitalize;
}

.finChartTip{
  position: fixed;
  z-index: 9999;
  padding: 10px 12px;
  border-radius: 12px;
  background: rgba(15,19,40,.78);
  border: 1px solid rgba(255,255,255,.12);
  backdrop-filter: blur(10px);
  box-shadow: 0 10px 30px rgba(0,0,0,.35);
  font-weight: 700;
  font-size: 13px;
  pointer-events: none;
}

.chart-line-income.draw,
.chart-line-expense.draw{
  transition: stroke-dashoffset 900ms ease;
}

/* Better hit areas for hover */
.chart-dot.hit{ cursor: pointer; }

/* Modal type pills + categories */
.finModalTop{ margin-bottom: 8px; }

.finTypePills{
  display:flex;
  gap:10px;
  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.10);
  border-radius: 999px;
  padding:6px;
}
.finTypePill{
  flex:1;
  border:none;
  border-radius:999px;
  padding:10px 12px;
  color: rgba(255,255,255,.85);
  background: transparent;
  font-weight: 700;
}
.finTypePill.active{
  background: rgba(255,255,255,0.10);
  color:#fff;
}

/* v10.0.8: make Expense/Income pill visibly active (color + glow) */
.finTypePills.is-income .finTypePill.active{
  background: rgba(52,211,153,0.14);
  box-shadow: 0 0 0 1px rgba(52,211,153,0.22), 0 0 22px rgba(52,211,153,0.20);
}
.finTypePills.is-expense .finTypePill.active{
  background: rgba(251,146,60,0.16);
  box-shadow: 0 0 0 1px rgba(251,146,60,0.24), 0 0 22px rgba(251,146,60,0.22);
}

.finCats{
  display:grid;
  grid-template-columns: repeat(4, minmax(0,1fr));
  gap:12px;
  margin-top:8px;
}

@media (max-width: 520px){
  .finCats{ grid-template-columns: repeat(3, minmax(0,1fr)); }
}

.finCatBtn{
  border:none;
  background: rgba(255,255,255,0.04);
  border:1px solid rgba(255,255,255,0.10);
  border-radius: 18px;
  padding:10px 10px 12px;
  text-align:center;
  color: rgba(255,255,255,.9);
  transition: transform .12s ease, background .12s ease, border-color .12s ease;
}
.finCatBtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.06); }
.finCatBtn.active{
  border-color: rgba(255,255,255,0.22);
  background: rgba(255,255,255,0.08);
}

.finCatIcon{
  width:64px;
  height:64px;
  border-radius:50%;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  background: rgba(255,255,255,0.02);
  margin-bottom: 8px;
}
.finCatIcon img{
  width:64px;
  height:64px;
  border-radius:50%;
  /* The PNG itself is the square (rounded corners, glow). Fill the slot 1:1. */
  object-fit:cover;
}
.finCatLabel{
  display:block;
  font-size: 12px;
  font-weight: 700;
  opacity: .9;
}

/* Header Entry button already styled as .entry-btn in v6.6.2 */


/* REFactor barrier v6.9.7: stability guards added in app.js */


/* v6.9.8 dark lock: hide theme switch until future patch */
#themeSelect,
[data-action="setTheme"]{
  display:none !important;
}


/* THEME_LOCK_v699 */
#themeSelect,
[data-action="setTheme"]{
  display:none !important;
}


/* v7.0.2 habit mobile */
@media (max-width: 520px){
  .habitHeadRow,.habitRow{
    grid-template-columns: minmax(130px, 1fr) repeat(7, 30px);
    gap:6px;
  }
  .habitName{min-width:130px}
  .habitBox{width:24px;height:24px}
  .habitIcon{font-size:16px}
  .habitText{font-size:13px}
  .chip{font-size:11px;padding:2px 8px}
}


/* v7.0.2 dark theme variables (locked) */
:root[data-theme="dark"]{
  --bg:#0b1020;
  --card: rgba(15,23,42,.62);
  --text:#e5e7eb;
  --sub:#93c5fd;
  --muted: rgba(229,231,235,.72);
  --shadow: 0 14px 40px rgba(0,0,0,.55);
  --shadow2: 0 10px 24px rgba(0,0,0,.42);
}
:root[data-theme="dark"] body{
  background: radial-gradient(1200px 800px at 20% 0%, rgba(251,146,60,.18), transparent 60%),
              radial-gradient(900px 700px at 80% 40%, rgba(59,130,246,.22), transparent 60%),
              var(--bg);
}
:root[data-theme="dark"] .card{
  background: linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
  border-color: rgba(255,255,255,.12);
}
:root[data-theme="dark"] .topbar{
  background: transparent;
}

/* v7.0.2 theme locked: hide theme button */
#btnTheme{display:none !important;}


/* v7.0.3 finances overlay (match design) */
.finHero{position:relative; overflow:hidden;}
.finChart{position:relative;}
.finStatsOverlay{
  position:absolute;
  top:16px;
  left:16px;
  right:16px;
  display:grid;
  grid-template-columns: 1.1fr 0.8fr 1.1fr;
  gap:14px;
  z-index:2;
}
.finChart{padding-top:110px;}
.finStatCard{
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius:16px;
  padding:14px 16px;
  backdrop-filter: blur(10px);
}
.finBalancePill{
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius:999px;
  padding:10px 14px;
  backdrop-filter: blur(10px);
}
@media (max-width:520px){
  .finChart{padding-top:0px;}
  .finStatsOverlay{
    position:static;
    grid-template-columns: 1fr;
    margin-bottom:12px;
  }
}
.topSettings{margin-right:8px;}

:root[data-theme="dark"] .finStatCard,
:root[data-theme="dark"] .finBalancePill{
  background: rgba(255,255,255,0.06);
  border-color: rgba(255,255,255,0.12);
}


/* v7.0.5 finances: stats inside chart */
.finChartShell{position:relative;}
.finChart{position:relative; padding-top:110px;}
.finStatsOverlay{
  position:absolute;
  top:16px; left:16px; right:16px;
  display:grid;
  grid-template-columns: 1.1fr 0.8fr 1.1fr;
  gap:14px;
  z-index:3;
}


/* v7.0.6 hide duplicate finances summary cards on phone */
@media (max-width: 520px){
  .finSummaryDup{ display:none !important; }
}


/* v7.0.7 mobile finances: match reference layout */
@media (max-width: 520px){
  /* page spacing */
  .page{ padding: 14px 14px 110px; }
  .section{ margin-bottom: 14px; }
  .card.section{ border-radius: 22px; }

  /* Finances header */
  .finHead{ gap: 12px; align-items: flex-start; }
  .finHead h1{ font-size: 34px; letter-spacing: -0.02em; margin: 0; }
  .finSub{ font-size: 14px; opacity: .75; margin-top: 4px; }

  /* Entry button: pill with + circle */
  .entry-btn{
    height: 48px;
    border-radius: 999px;
    padding: 0 16px 0 16px;
    font-weight: 800;
    box-shadow: 0 14px 26px rgba(0,0,0,.35);
  }
  .entry-btn .plusCircle{
    width: 34px; height: 34px;
    margin-left: 12px;
  }

  /* Chart block */
  .finHero{ padding: 14px; }
  .finChartShell{ border-radius: 22px; overflow: hidden; }
  .finChart{ padding-top: 118px; } /* space for overlay */
  .finSvg{ height: 220px; } /* taller like reference */
  .finLegend{ margin-top: 10px; }

  /* Stats overlay: keep 3 across like reference */
  .finStatsOverlay{
    position:absolute;
    top:14px; left:14px; right:14px;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 10px;
    margin: 0;
  }
  .finStatCard{ padding: 12px 12px; border-radius: 18px; }
  .finStatTitle{ font-size: 13px; opacity: .8; margin-bottom: 6px; }
  .finStatValue{ font-size: 18px; letter-spacing:-0.01em; }
  .finStatDelta{ font-size: 12px; opacity: .75; }
  .finBalancePill{ padding: 10px 12px; border-radius: 999px; }
  .finBalancePill .finStatTitle{ text-align:center; }
  .finBalancePill .finStatValue{ text-align:center; }

  /* Goals / Recent entries cards */
  .goalsHead h2, .recentHead h2{ font-size: 22px; }
  .goalCard, .recentCard{ border-radius: 20px; }
  .goalCard{ padding: 14px; }
  .recentItem{ border-radius: 18px; padding: 12px; }
  .recentName{ font-size: 16px; }
  .recentMeta{ font-size: 12px; opacity: .75; }
  .chip{ border-radius: 999px; }

  /* Reduce double columns on phone to match reference */
  .goalsGrid{ grid-template-columns: 1fr !important; }
  .finEntriesGrid{ grid-template-columns: 1fr !important; }
}


/* v7.0.8 header: move language + settings to top-right */
.topbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
}
.topActions{
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:10px;
}
.langPill{
  width:44px;
  height:44px;
  border-radius:999px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  font-weight:800;
}
.topSettings{
  width:44px;
  height:44px;
  border-radius:999px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
}


/* v7.0.9 mobile stacking fix */
@media (max-width:520px){
  .finHero{ position:relative; z-index:1; }
  .finStatsOverlay{ z-index:2; }
  .goalsSection, .recentSection{
    position:relative;
    z-index:1;
    margin-top:14px;
  }
  /* prevent header overlap */
  .topbar{
    position:sticky;
    top:0;
    z-index:5;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    background: linear-gradient(180deg, rgba(6,14,28,0.72), rgba(6,14,28,0.35));
    border-bottom: 1px solid rgba(255,255,255,0.08);
    padding-top: env(safe-area-inset-top, 0px);
  }
}


/* v7.1.1 mobile: place Goals & Recent under chart */
@media (max-width:520px){
  /* disable left overlay column */
  .goalsSection,
  .recentSection{
    position:static !important;
    width:100% !important;
    margin-left:0 !important;
    margin-right:0 !important;
  }

  /* ensure order: chart -> goals -> recent */
  .financesPage{
    display:flex;
    flex-direction:column;
  }
  .finHero{ order:1; }
  .goalsSection{ order:2; }
  .recentSection{ order:3; }

  /* spacing polish */
  .goalsSection,
  .recentSection{
    margin-top:16px;
  }
}


/* v7.1.2 mobile overflow fix: prevent horizontal split */
html, body { overflow-x: hidden; }

@media (max-width:520px){
  .pageStack{ width:100%; max-width:100%; }
  .pageStack > .section{ width:100%; max-width:100%; }
  .finHero, .finGlass{ width:100%; max-width:100%; }
  .finChartShell, .finChart{ width:100%; max-width:100%; }
  .finSvg{ width:100%; height:auto; }

  /* Ensure inner grids don't force wide layout */
  .finGoalsGrid2{ grid-template-columns: 1fr !important; }
  .finEntriesGrid{ grid-template-columns: 1fr !important; }

  /* Allow flex children to shrink instead of forcing overflow */
  .finHeroHead, .finSectionHead{ min-width:0; }
  .finHeroHead > *, .finSectionHead > *{ min-width:0; }
}


/* v7.1.3 app mobile width: prevent desktop max-width on phone */
@media (max-width: 520px){
  .app{
    max-width: 100% !important;
    width: 100% !important;
    margin: 0 !important;
    padding: 14px 14px 110px !important;
  }
}


/* v7.2.0 finances rewrite: stable layout */
.finChartShell{position:relative; overflow:hidden; border-radius:20px;}
.finStatsOverlay{position:absolute; top:14px; left:14px; right:14px; display:grid; grid-template-columns: 1fr 1fr 1fr; gap:12px; z-index:2; pointer-events:none;}
/* v10.0.8: allow stat cards/legend to be interactive without blocking chart */
.finStatsOverlay .finStatCard{pointer-events:auto; cursor:pointer;}
.finStatsOverlay .finBalancePill{pointer-events:none;}
.finChart{position:relative; z-index:1; padding-top:128px;}

/* v10.0.8: active focus styling */
.finStatCard.active{box-shadow: 0 0 0 1px rgba(255,255,255,0.18), 0 18px 60px rgba(0,0,0,0.22), 0 0 26px rgba(255,255,255,0.10); transform: translateY(-1px);}

/* Focus dims the non-selected series */
.finChartShell.focus-income .chart-line-expense{opacity:0.18; filter:none;}
.finChartShell.focus-income .chart-line-income{opacity:1;}
.finChartShell.focus-expense .chart-line-income{opacity:0.18; filter:none;}
.finChartShell.focus-expense .chart-line-expense{opacity:1;}

.finLegend{display:flex; gap:12px; justify-content:center; margin-top:8px;}
.finLegendItem{pointer-events:auto; cursor:pointer; user-select:none; opacity:0.85;}
.finLegendItem.active{opacity:1; text-shadow: 0 0 10px rgba(255,255,255,0.18);}
.finChartShell.focus-income .finLegendItem:not(.active){opacity:0.55;}
.finChartShell.focus-expense .finLegendItem:not(.active){opacity:0.55;}

@media (max-width:520px){
  .finStatsOverlay{grid-template-columns:1fr 1fr 1fr; gap:10px; top:14px; left:14px; right:14px;}
  .finChart{padding-top:122px;}
  .finGoalsGrid2, .finEntriesGrid{grid-template-columns:1fr !important;}
}

@media (max-width:390px){
  .finStatsOverlay{gap:8px; top:12px; left:12px; right:12px;}
  .finChart{padding-top:114px;}
  .finStatsOverlay .finStatCard{padding:8px 10px;border-radius:14px}
  .finStatsOverlay .finBalancePill{padding:8px 10px;border-radius:16px;min-width:unset}
  .finStatsOverlay .finStatValue, .finStatsOverlay .finBalanceValue{font-size:16px}
  .finStatsOverlay .finStatLabel, .finStatsOverlay .finBalanceLabel{font-size:11px}
}

/* Compact nav icon set (<=420px) */
.tab.compactIcons .ico{
  background: rgba(255,255,255,0.06);
}
.tab.compactIcons .icoImg{
  width:28px;
  height:28px;
  object-fit:contain;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}
@media (max-width:420px){
  .tab.compactIcons .ico{width:54px;height:48px;border-radius:14px;}
  .tab.compactIcons{gap:6px;}
}


/* ===== v10.2.2 logo blend + finances polish ===== */

/* Header brand + logo: blend more naturally into the background */
.brand{display:flex;align-items:center;gap:12px;min-width:0;}

.logo{
  width:46px;
  height:46px;
  border-radius:16px;
  display:grid;
  place-items:center;
  overflow:hidden;
  background: linear-gradient(135deg, rgba(255,255,255,0.10), rgba(255,255,255,0.03));
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 18px 40px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
  backdrop-filter: blur(10px);
}

.logoImg{
  width:34px;
  height:34px;
  object-fit:contain;
  opacity:0.92;
  filter: saturate(1.08) contrast(1.06) drop-shadow(0 10px 18px rgba(0,0,0,0.35));
  /* helps the logo feel like it belongs on the space background */
  mix-blend-mode: screen;
}

@media (max-width:520px){
  .logo{width:44px;height:44px;border-radius:15px}
  .logoImg{width:32px;height:32px}
}

:root[data-theme="light"] .logo{
  background: linear-gradient(135deg, rgba(255,255,255,0.82), rgba(255,255,255,0.52));
  border-color: rgba(15,23,42,0.10);
  box-shadow: 0 14px 26px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255,255,255,0.55);
}

:root[data-theme="light"] .logoImg{mix-blend-mode: normal; opacity:0.98;}


/* Finances: tighten typography, improve input + cards */
.finHeroHead .h1{font-size:clamp(20px, 4.8vw, 34px); line-height:1.05; letter-spacing:-0.02em;}
.finHeroHead .sub{color: rgba(255,255,255,0.70);}

/* Search input (HTML uses .finSearch) */
.finSearch{
  width:min(360px, 100%);
  padding:12px 14px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  color: var(--text);
  outline:none;
  backdrop-filter: blur(14px);
  transition: border-color .18s ease, transform .18s ease, box-shadow .18s ease;
}
.finSearch:focus{
  border-color: rgba(167,139,250,.45);
  box-shadow: 0 0 0 4px rgba(167,139,250,.12);
  transform: translateY(-1px);
}

/* Make bubbles + entry cards feel more premium */
.finBubble{
  background: radial-gradient(80px 80px at 30% 25%, rgba(255,255,255,0.10), rgba(0,0,0,0.22));
  border-color: rgba(255,255,255,0.14);
  box-shadow: 0 14px 34px rgba(0,0,0,0.22);
}

.finEntryCard{
  background: linear-gradient(135deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
  border-color: rgba(255,255,255,0.12);
  box-shadow: 0 16px 44px rgba(0,0,0,0.18);
}
.finEntryCard:hover{
  border-color: rgba(255,255,255,0.18);
  box-shadow: 0 18px 60px rgba(0,0,0,0.22), 0 0 26px rgba(255,255,255,0.06);
}

.finEntrySub{flex-wrap:wrap; row-gap:6px;}

@media (max-width:390px){
  .finEntryTop{flex-wrap:wrap; align-items:flex-start;}
  .finEntryAmount{margin-left:auto;}
}

/* Light theme finance tweaks */
:root[data-theme="light"] .finSearch{
  background: rgba(255,255,255,0.70);
  border-color: rgba(15,23,42,0.12);
}

/* ===== end v10.2.2 ===== */

/* ============================================================
   v10.0.0 — Global polish overrides (final)
   These are placed at the end of the file to win specificity.
============================================================ */

:root{
  --primaryNeon:#ff4dff;
  --textSoft: rgba(255,255,255,.88);
}

body{ line-height: 1.45; }

.app{ padding:16px 16px 112px; }

.h1{ font-size:20px; letter-spacing:-0.01em; }
.sub{ opacity:.92; }

.section{ padding:18px; margin:14px 0; }
.card{ border-color: rgba(255,255,255,.08); }

.kpi{ background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.08); }
.kpi .l{ opacity:.92; }

.bottomnav.neonNav{ box-shadow: 0 20px 65px rgba(0,0,0,.65), 0 0 44px rgba(255,77,255,.10); }

.tab.neonTab{ color: var(--textSoft); }
.tab.neonTab.active{ color:#fff; }

.tab.neonTab.active::after{
  transition: transform .16s ease, opacity .16s ease, filter .16s ease;
  transform: translateY(0);
}

.tab.neonTab:not(.active)::after{
  opacity: 0;
  transform: translateY(2px);
}

@media (max-width:520px){
  .app{ padding:14px 14px 110px !important; }
  .h1{ font-size:18px; }
  .section{ padding:16px; }
}

/* ===== v10.0.2 Habit tracker: cinematic background + neon pills (match reference) ===== */
.habitSectionFix{
  position:relative;
  overflow:hidden;
  isolation:isolate;
  border-radius:26px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(10,14,32,0.55);
  box-shadow:
    0 28px 60px rgba(0,0,0,0.55),
    inset 0 1px 0 rgba(255,255,255,0.10);
}

/* Starfield / nebula layer (uses existing background.png from v9.9) */
.habitSectionFix::before{
  content:"";
  position:absolute;
  inset:-60px;
  background-image:url('./background.png');
  background-size:cover;
  background-position: 85% 35%;
  opacity:0.92;
  transform:scale(1.06);
  filter:saturate(1.25) contrast(1.10) brightness(0.92);
  z-index:-2;
}

/* Readability overlay + depth (keep center darker so comets pop) */
.habitSectionFix::after{
  content:"";
  position:absolute;
  inset:0;
  background:
    /* v10.1.8: stronger cyan energy that reads across the whole card */
    radial-gradient(1400px 900px at 70% 40%, rgba(0,220,255,0.18), rgba(0,140,255,0.10) 55%, transparent 74%),
    radial-gradient(900px 520px at 75% 35%, rgba(120,80,255,0.14), transparent 60%),
    radial-gradient(800px 480px at 20% 20%, rgba(255,90,200,0.08), transparent 65%),
    linear-gradient(90deg, rgba(5,7,18,0.86) 0%, rgba(5,7,18,0.62) 55%, rgba(5,7,18,0.42) 100%);
  z-index:-1;
}


/* Tighten header spacing on the habit card */
.habitSectionFix .cardHead{
  gap:16px;
  align-items:flex-start;
}

.habitTitle{font-size:44px; font-weight:900; letter-spacing:-0.03em;}
.habitRange{font-size:22px; font-weight:800; color:rgba(255,255,255,0.75);}

/* Comfy week selector container (dark pill with purple glow) */
.weekComfy{
  background:
    radial-gradient(120px 70px at 30% 20%, rgba(255,255,255,0.10), transparent 55%),
    linear-gradient(180deg, rgba(25,18,55,0.65), rgba(12,10,28,0.55));
  border:1px solid rgba(210, 140, 255, 0.22);
  box-shadow:
    0 18px 36px rgba(0,0,0,0.50),
    inset 0 1px 0 rgba(255,255,255,0.10),
    inset 0 0 0 2px rgba(140, 70, 255, 0.14),
    0 0 18px rgba(170, 70, 255, 0.28),
    0 0 34px rgba(70, 170, 255, 0.14);
  backdrop-filter: blur(10px);
}

.weekComfyLabel{
  color: rgba(255,255,255,0.35);
  font-weight:900;
  letter-spacing:0.02em;
}

/* Inner cyan/blue pill (matches reference) */
.weekComfyPill{
  position:relative;
  border:1px solid rgba(120,220,255,0.48);
  background:
    radial-gradient(80px 40px at 35% 25%, rgba(255,255,255,0.18), transparent 60%),
    linear-gradient(90deg, rgba(0,150,210,0.62), rgba(20,230,255,0.60));
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,0.22),
    inset 0 0 0 1px rgba(255,255,255,0.10),
    0 16px 30px rgba(0,0,0,0.40),
    0 0 26px rgba(70, 200, 255, 0.42),
    0 0 38px rgba(170, 60, 255, 0.16);
}

.weekComfyValue{
  font-size:22px;
  font-weight:900;
  color: rgba(255,255,255,0.92);
  letter-spacing:0.01em;
}

.weekComfyCaret{
  font-size:18px;
  opacity:0.95;
}

/* + Habit button (red/orange neon pill) */
.habitAddBtn{
  /* Match the reference: dark capsule with hot orange rim + strong right-side glow */
  position: relative;
  border-radius:999px !important;
  /* v10.1.7: make the button a bit smaller/cleaner */
  padding:12px 22px !important;
  min-height:46px;
  color: rgba(255,255,255,0.96) !important;
  border: 2px solid rgba(255,190,110,0.82) !important;
  background:
    radial-gradient(140px 70px at 65% 30%, rgba(255,255,255,0.10), transparent 58%),
    linear-gradient(90deg, rgba(10,12,26,0.92), rgba(26,18,34,0.88)) !important;
  box-shadow:
    0 18px 40px rgba(0,0,0,0.56),
    inset 0 1px 0 rgba(255,255,255,0.14),
    inset 0 0 0 2px rgba(255,130,70,0.18),
    0 0 30px rgba(255,170,70,0.70),
    0 0 60px rgba(255,120,60,0.42);
  backdrop-filter: blur(8px);
  transform: translateZ(0);
}

/* Right-side hot bloom (gives the “comet head” rim) */
.habitAddBtn::after{
  content:"";
  position:absolute;
  inset:-10px;
  border-radius:999px;
  /* v10.1.8: push the hot glow to the very edge of the capsule (comet head at the tip) */
  background: radial-gradient(260px 140px at 102% 50%, rgba(255,230,170,0.62), rgba(255,150,80,0.28) 45%, transparent 72%);
  filter: blur(8px);
  z-index:-1;
  pointer-events:none;
}

/* ===== v10.1.4: WebGL Comet Button for + Habit (no comet plate image) ===== */
.habitAddBtn.cometWebglBtn{
  position: relative;
  overflow: visible; /* canvas extends past the pill */
}

.habitAddBtn.cometWebglBtn .cometWebgl{
  position:absolute;
  /* v10.1.8: anchor the WebGL canvas so the comet head can sit at the capsule tip */
  left:auto;
  right:-44px;
  top:-60px;
  width: calc(100% + 310px);
  height: calc(100% + 120px);
  z-index:0;
  pointer-events:none;
  filter: saturate(1.15) contrast(1.05);
  mix-blend-mode: screen;
}

/* v10.1.8: big blue/purple energy wash behind the whole habit header (no hard wedges) */
.habitSectionFix .cardHead{
  position:relative;
  overflow:hidden;
}
.habitSectionFix .cardHead::before{
  content:"";
  position:absolute;
  inset:-45%;
  pointer-events:none;
  z-index:0;
  background:
    radial-gradient(900px 560px at 70% 40%, rgba(0,220,255,0.28), rgba(0,140,255,0.16) 55%, rgba(0,80,200,0.06) 72%, transparent 78%),
    radial-gradient(1400px 820px at 40% 65%, rgba(150,60,255,0.20), rgba(80,0,180,0.10) 60%, transparent 78%);
  filter: blur(28px);
  mix-blend-mode: screen;
  opacity: 0.95;
}
.habitSectionFix .cardHead > *{ position:relative; z-index:1; }

.habitAddBtn.cometWebglBtn .cometBtnContent{
  position:relative;
  z-index:1;
  display:inline-flex;
  align-items:center;
  gap:10px;
}

.habitAddBtn.cometWebglBtn .cometBtnPlus{
  font-weight:900;
  font-size:22px;
  line-height:1;
  padding: 0;
  border-radius:0;
  background: transparent;
  box-shadow: none;
  text-shadow: 0 0 16px rgba(255,200,120,0.55);
}

.habitAddBtn.cometWebglBtn .cometBtnText{
  font-size:18px;
  font-weight:900;
  letter-spacing:-0.01em;
  text-shadow: 0 2px 10px rgba(0,0,0,0.35);
}

.habitAddBtn:hover{
  filter: brightness(1.04);
}

.habitAddBtn:active{
  transform: scale(0.985);
}

/* Match reference: keep only the "+ Habit" label (avoid double plus) */
.habitAddBtn .addPillPlus{display:none !important;}

.habitAddBtn .addPillText{
  font-size:22px;
  font-weight:900;
  letter-spacing:-0.01em;
}

/* Give the habit grid a little more breathing room inside this hero card */
.habitWrap{margin-top:18px;}

/* Darken header row background so it reads on the cinematic backdrop */
.habitHeadRow{
  background: rgba(10,14,32,0.45) !important;
  border-bottom:1px solid rgba(255,255,255,0.10) !important;
  backdrop-filter: blur(8px);
}

.habitRow{
  border-bottom: 1px solid rgba(255,255,255,0.06) !important;
}

/* Slightly stronger day letters */
.habitDay{ color: rgba(255,255,255,0.62) !important; }

/* Responsive: keep the hero typography from blowing up on small screens */
@media (max-width: 520px){
  .habitTitle{font-size:26px;}
  .habitRange{font-size:13px;}
  .weekComfyValue{font-size:13px;}
  .habitAddBtn{min-height:46px; padding:12px 16px !important;}
  .habitAddBtn .addPillText{font-size:14px;}
}

/* ===== v10.1.1 Habit tracker: TRUE comet FX (CSS-only) positioned behind the pills ===== */
.habitControls{
  position:relative;
  isolation:isolate; /* local stacking context */
  z-index:0;
  display:flex;
  gap:12px;
  align-items:center;
  flex-wrap:wrap;
  justify-content:flex-end;
  overflow:visible; /* allow comet heads to extend behind pills */
}

/* Comet layers are real elements so we can position them precisely (desktop + mobile) */
.cometFx{
  position:absolute;
  pointer-events:none;
  z-index:1;
  /* Bigger comet field so the blue/purple streak reads like the reference */
  /* v10.1.8: expand the FX so the blue energy reads across the whole card */
  width:1200px;
  height:420px;
  opacity:0.95;
  mix-blend-mode: screen;
  /* Anchor comet HEAD near the button; tail flows left */
  transform:
    translate3d(
      calc(var(--fx-x, 0px) - 1080px),
      calc(var(--fx-y, 0px) - 190px),
      0
    )
    rotate(var(--fx-rot, -12deg));
  filter: saturate(1.75) contrast(1.35)
          drop-shadow(0 0 22px rgba(255,255,255,0.16))
          drop-shadow(0 0 46px rgba(120,120,255,0.10));
  /* comet silhouette (tapered tail + rounded head) */
  clip-path: polygon(
    0% 62%,
    18% 54%,
    42% 34%,
    70% 22%,
    100% 40%,
    100% 60%,
    70% 78%,
    42% 70%,
    18% 64%,
    0% 52%
  );
}

@media (max-width: 520px){
  .cometFx{
    width:980px;
    height:360px;
    opacity:0.98;
    transform:
      translate3d(
        calc(var(--fx-x, 0px) - 900px),
        calc(var(--fx-y, 0px) - 200px),
        0
      )
      rotate(var(--fx-rot, -12deg));
    filter: saturate(1.8) contrast(1.4)
            drop-shadow(0 0 24px rgba(255,255,255,0.18))
            drop-shadow(0 0 52px rgba(120,120,255,0.12));
  }
}

/* Two-layer comet: glow + core + sparks */
.cometFx::before,
.cometFx::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:999px;
}

/* WEEK comet (blue/purple) */
.cometWeek{
  left:0;
  top:0;
  --fx-rot: -12deg;
}

.cometWeek::before{
  /* Head burst + glow body + tail fade (looks like a comet, not a prism) */
  background:
    /* HEAD burst (electric) */
    radial-gradient(circle at 96% 50%,
      rgba(255,255,255,1) 0 14px,
      rgba(120,240,255,0.95) 14px 36px,
      rgba(160,110,255,0.70) 36px 62px,
      transparent 64px),
    /* Body glow */
    radial-gradient(ellipse at 86% 50%,
      rgba(90,220,255,0.42),
      rgba(80,160,255,0.18) 52%,
      transparent 74%),
    /* Tail tint (brighter + longer) */
    linear-gradient(90deg,
      rgba(60,120,255,0.00) 0%,
      rgba(120,120,255,0.08) 12%,
      rgba(120,180,255,0.18) 24%,
      rgba(90,220,255,0.30) 42%,
      rgba(180,110,255,0.22) 58%,
      rgba(0,0,0,0) 88%);
  filter: blur(5.5px);
}

.cometWeek::after{
  /* Core streak + dense sparks + tiny trail particles */
  background:
    /* CORE (thin bright spine) */
    linear-gradient(90deg,
      transparent 0%,
      transparent 14%,
      rgba(255,255,255,0.0) 44%,
      rgba(255,255,255,1.0) 49.3%,
      rgba(120,240,255,1.0) 50.0%,
      rgba(190,110,255,0.95) 50.7%,
      rgba(255,255,255,0.0) 54%,
      transparent 100%),
    /* Spark explosion near head */
    radial-gradient(circle at 92% 44%, rgba(255,255,255,0.95) 0 1.6px, transparent 4.6px),
    radial-gradient(circle at 94% 58%, rgba(255,255,255,0.78) 0 1.4px, transparent 4.3px),
    radial-gradient(circle at 90% 52%, rgba(210,240,255,0.80) 0 1.6px, transparent 4.7px),
    radial-gradient(circle at 88% 40%, rgba(255,120,255,0.70) 0 1.4px, transparent 4.4px),
    radial-gradient(circle at 96% 50%, rgba(140,220,255,0.85) 0 1.8px, transparent 5.1px),
    /* Tail particles */
    radial-gradient(circle at 70% 48%, rgba(180,220,255,0.35) 0 1px, transparent 3.4px),
    radial-gradient(circle at 58% 56%, rgba(220,170,255,0.28) 0 1px, transparent 3.4px),
    radial-gradient(circle at 46% 44%, rgba(160,220,255,0.22) 0 1px, transparent 3.2px);
  filter: blur(0.9px);
}

/* ADD comet (orange/red) */
.cometAdd{
  left:0;
  top:0;
  --fx-rot: -10deg;
}

.cometAdd::before{
  background:
    /* HEAD burst (fiery) */
    radial-gradient(circle at 96% 50%,
      rgba(255,255,255,1) 0 14px,
      rgba(255,230,160,0.95) 14px 34px,
      rgba(255,120,60,0.78) 34px 62px,
      rgba(255,70,50,0.45) 62px 78px,
      transparent 80px),
    /* Body glow */
    radial-gradient(ellipse at 86% 50%,
      rgba(255,180,90,0.36),
      rgba(255,120,60,0.16) 52%,
      transparent 74%),
    /* Tail tint */
    linear-gradient(90deg,
      rgba(255,80,60,0.00) 0%,
      rgba(255,80,60,0.14) 22%,
      rgba(255,180,90,0.20) 50%,
      rgba(0,0,0,0) 80%);
  filter: blur(7px);
}

.cometAdd::after{
  background:
    /* CORE (thin bright spine) */
    linear-gradient(90deg,
      transparent 0%,
      transparent 14%,
      rgba(255,255,255,0.0) 44%,
      rgba(255,255,240,1.0) 49.3%,
      rgba(255,190,110,1.0) 50.0%,
      rgba(255,90,60,0.98) 50.7%,
      rgba(255,255,255,0.0) 54%,
      transparent 100%),
    /* Spark explosion near head */
    radial-gradient(circle at 92% 44%, rgba(255,255,255,0.95) 0 1.6px, transparent 4.6px),
    radial-gradient(circle at 94% 58%, rgba(255,255,255,0.76) 0 1.4px, transparent 4.3px),
    radial-gradient(circle at 90% 52%, rgba(255,220,180,0.78) 0 1.6px, transparent 4.7px),
    radial-gradient(circle at 88% 40%, rgba(255,140,90,0.74) 0 1.4px, transparent 4.4px),
    radial-gradient(circle at 96% 50%, rgba(255,190,120,0.82) 0 1.8px, transparent 5.1px),
    /* Tail particles */
    radial-gradient(circle at 70% 48%, rgba(255,210,150,0.28) 0 1px, transparent 3.4px),
    radial-gradient(circle at 58% 56%, rgba(255,150,100,0.22) 0 1px, transparent 3.4px),
    radial-gradient(circle at 46% 44%, rgba(255,220,160,0.18) 0 1px, transparent 3.2px);
  filter: blur(0.9px);
}

/* Pills above FX */
.weekComfy,
.habitAddBtn{ position:relative; z-index:2; }

/* ===== v10.0.4 Tap ripple energy (buttons) ===== */
.rippleHost{
  position: relative;
  overflow: hidden;
  -webkit-tap-highlight-color: transparent;
}

.ripple{
  position: absolute;
  border-radius: 999px;
  transform: scale(0);
  opacity: 0.9;
  mix-blend-mode: screen;
  pointer-events: none;
  animation: rippleEnergy 520ms ease-out forwards;
  background: radial-gradient(circle, rgba(255,255,255,0.55), rgba(255,255,255,0.12) 35%, transparent 70%);
}

.ripple[data-tone="cyan"]{
  background: radial-gradient(circle, rgba(140,230,255,0.75), rgba(0,210,255,0.18) 38%, transparent 72%);
}

.ripple[data-tone="orange"]{
  background: radial-gradient(circle, rgba(255,235,170,0.75), rgba(255,140,60,0.22) 40%, transparent 74%);
}

@keyframes rippleEnergy{
  0%{ transform: scale(0); opacity: 0.0; }
  8%{ opacity: 0.95; }
  100%{ transform: scale(1); opacity: 0; }
}

/* Slightly punchier button glows to match reference */
.weekComfy{
  box-shadow:
    0 18px 36px rgba(0,0,0,0.45),
    0 0 0 1px rgba(185, 70, 255, 0.12) inset,
    0 0 26px rgba(185, 70, 255, 0.30);
}

.weekComfyPill{
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,0.22),
    0 16px 30px rgba(0,0,0,0.40),
    0 0 28px rgba(70, 170, 255, 0.45),
    0 0 44px rgba(170, 60, 255, 0.22);
}

.habitAddBtn{
  box-shadow:
    0 18px 34px rgba(0,0,0,0.45),
    0 0 30px rgba(255,70,70,0.60),
    0 0 52px rgba(255,160,40,0.42);
}

@media (max-width: 520px){
  .habitControls::before{ right:120px; top:-20px; width:320px; height:160px; }
  .habitControls::after{ right:-30px; top:-28px; width:320px; height:180px; }
}

/* ============================================================
   v10.2.0 — Habit tracker visual optimization
   Goals:
   - Clearer hierarchy (title/range scale, contrast)
   - Card-like habit rows with hover/focus depth
   - Checkbox micro-interactions + per-habit color glow
   - KPI tiles feel more premium
============================================================ */

/* Typography polish */
body{ font-feature-settings: "tnum"; }

/* Headline/range scale: keep the bold look but avoid overlap on small screens */
.habitTitle{ font-size: clamp(28px, 5.2vw, 44px); line-height: 1.02; }
.habitRange{ font-size: clamp(14px, 2.6vw, 22px); font-weight: 800; }

/* Make the sticky header row more legible over the cinematic background */
.habitHeadRow{
  background: rgba(5,7,18,0.70);
  border-bottom: 1px solid rgba(255,255,255,0.08);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border-radius: 14px;
  padding: 10px 10px 12px;
}

/* Habit rows as soft cards */
.habitWrap{ padding-top: 8px; }
.habitRow{
  border-bottom: none;
  padding: 12px 10px;
  margin: 10px 0;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,0.08);
  background:
    radial-gradient(180px 110px at 20% 20%, rgba(255,255,255,0.08), transparent 60%),
    rgba(255,255,255,0.04);
  box-shadow:
    0 14px 34px rgba(0,0,0,0.32),
    inset 0 1px 0 rgba(255,255,255,0.08);
  transition: transform .16s ease, box-shadow .18s ease, background .18s ease, border-color .18s ease;
}
.habitRow:hover{
  transform: translateY(-1px);
  border-color: rgba(255,255,255,0.12);
  background:
    radial-gradient(200px 130px at 20% 20%, rgba(255,255,255,0.10), transparent 60%),
    rgba(255,255,255,0.05);
  box-shadow:
    0 18px 46px rgba(0,0,0,0.40),
    inset 0 1px 0 rgba(255,255,255,0.10);
}
.habitRow:focus-within{
  border-color: rgba(120,220,255,0.25);
  box-shadow:
    0 18px 46px rgba(0,0,0,0.42),
    0 0 0 2px rgba(120,220,255,0.14),
    inset 0 1px 0 rgba(255,255,255,0.10);
}

/* Checkbox grid: slightly bigger, rounded squares + stronger affordance */
.habitBox{
  width: 30px;
  height: 30px;
  border-radius: 12px;
  border: 1.5px solid rgba(255,255,255,0.22) !important;
  background:
    radial-gradient(14px 12px at 30% 28%, rgba(255,255,255,0.12), transparent 60%),
    rgba(0,0,0,0.18) !important;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,0.08),
    inset 0 0 0 1px rgba(0,0,0,0.14),
    0 10px 18px rgba(0,0,0,0.25);
  transition: transform .14s ease, box-shadow .18s ease, filter .18s ease, background .18s ease;
}
.habitBox:hover{ transform: translateY(-1px) scale(1.03); }
.habitBox:active{ transform: scale(.95); }

/* On-state: per-habit color + glow + subtle highlight */
.habitBox.on{
  color: var(--hc);
  border-color: rgba(255,255,255,0.25) !important;
  background:
    radial-gradient(16px 14px at 30% 28%, rgba(255,255,255,0.40), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,0.10), rgba(0,0,0,0.08)),
    var(--hc) !important;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,0.22),
    inset 0 0 0 1px rgba(255,255,255,0.10),
    0 16px 30px rgba(0,0,0,0.38),
    0 0 16px currentColor;
  animation: hbPop .18s ease-out;
}

/* Existing .pulse class is used when toggled; make it feel intentional */
.habitBox.pulse{
  animation: hbPulse .70s ease-out;
}

@keyframes hbPop{
  from{ transform: scale(.90); filter: brightness(0.95); }
  to{ transform: scale(1.00); filter: brightness(1.05); }
}

@keyframes hbPulse{
  0%{ transform: scale(1.00); box-shadow: 0 0 0 0 currentColor, 0 16px 30px rgba(0,0,0,0.38); }
  55%{ transform: scale(1.06); box-shadow: 0 0 0 10px rgba(255,255,255,0.00), 0 18px 34px rgba(0,0,0,0.44); }
  100%{ transform: scale(1.00); }
}

/* KPI tiles: more premium "glass" */
.habitStats{ gap: 12px; margin-top: 16px; }
.habitStats .kpi{
  border-radius: 20px;
  background:
    radial-gradient(180px 120px at 25% 20%, rgba(255,255,255,0.10), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow:
    0 18px 44px rgba(0,0,0,0.40),
    inset 0 1px 0 rgba(255,255,255,0.10);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}
.habitStats .kpi .v{ letter-spacing: -0.02em; }

@media (max-width:520px){
  /* v10.2.4: tighter phone grid so ALL 7 days always fit (no cutoff) */
  .habitHeadRow,.habitRow{ grid-template-columns: minmax(120px, 1fr) repeat(7, minmax(22px, 1fr)); }
  .habitBox{ width: clamp(22px, 6vw, 26px); height: clamp(22px, 6vw, 26px); border-radius: 10px; }
  .habitHeadRow{ padding: 8px 10px 10px; }
  .habitDay{ font-size: 11px; }
}

/* ===== v10.2.1 Habit tracker: header layout polish + ensure 7-day grid fits on phones ===== */

/* Header: make the hero feel intentional (Title + Add on row 1, Range + Week on row 2) */
.habitSectionFix .cardHead{
  display:grid;
  grid-template-columns: 1fr auto;
  grid-template-rows: auto auto;
  gap: 10px 14px;
  align-items:start;
}

/* Left block (title + range) */
.habitSectionFix .cardHead > div:first-child{ grid-column: 1; grid-row: 1 / span 2; }

/* Right block (week + add) becomes a 2-row grid */
.habitControls{
  display:grid;
  grid-template-columns: 1fr;
  grid-template-rows: auto auto;
  row-gap: 10px;
  justify-items:end;
  align-items:center;
}

/* Place +Habit on top-right, week selector under it */
.habitControls .habitAddBtn{ grid-row: 1; }
.habitControls .weekComfy{ grid-row: 2; }

/* Slightly stronger readability for the title/range over the cinematic header */
.habitTitle{
  text-shadow: 0 8px 28px rgba(0,0,0,0.55);
}
.habitRange{
  text-shadow: 0 6px 20px rgba(0,0,0,0.45);
}

/* Phone: make header compact + balanced (week + add live on the same row) */
@media (max-width: 420px){
  .habitSectionFix .cardHead{
    display:flex;
    flex-direction:column;
    gap: 10px;
  }
  .habitSectionFix .cardHead > div:first-child{ width:100%; }
  .habitControls{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    justify-content:flex-start;
    align-items:center;
    width:100%;
  }
  .habitControls .weekComfy{ flex: 1 1 220px; min-width: 0; }
  .habitControls .habitAddBtn{ flex: 0 0 auto; }
  /* keep the week pill from feeling oversized */
  .weekComfy{ padding: 9px 12px; }
  .weekComfyPill{ padding: 9px 12px; }
  .weekComfyValue{ font-size: 12px; }
}

/* Ensure all 7 days are visible on narrow screens without horizontal scrolling */
@media (max-width: 420px){
  .habitWrap{ overflow-x: hidden; }
  .habitHeadRow,.habitRow{
    /* slightly tighter than v10.2.1 to guarantee the last day never clips */
    grid-template-columns: minmax(96px, 1fr) repeat(7, minmax(20px, 1fr));
    gap: 6px;
  }
  .habitDay{ font-size: 11px; }
  .habitBox{
    width: clamp(22px, 6vw, 26px);
    height: clamp(22px, 6vw, 26px);
    border-radius: 10px;
  }
  .habitRow{ padding: 10px 10px; }
  .habitHeadRow{ padding: 8px 10px 10px; }
}

@media (max-width: 360px){
  .habitHeadRow,.habitRow{ grid-template-columns: minmax(88px, 1fr) repeat(7, minmax(18px, 1fr)); gap: 5px; }
  .habitIcon{ font-size: 16px; }
  .chip{ transform: scale(0.95); }
}



/* ===== Build 2: полностью нов header (balanced + modern glass) ===== */
.topbar{
  position: sticky;
  top: 0;
  z-index: 10;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 14px;
  margin: 8px 0 14px;
  border-radius: 22px;

  /* Let the space background breathe: subtle glass surface */
  background: linear-gradient(
    180deg,
    rgba(15, 23, 42, 0.62),
    rgba(2, 6, 23, 0.36)
  );

  border: 1px solid rgba(255,255,255,0.12);
  box-shadow:
    0 18px 55px rgba(0,0,0,0.42),
    inset 0 1px 0 rgba(255,255,255,0.10);

  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  overflow: hidden;
}

/* Soft aurora glow (balanced, not neon) */
.topbar::before{
  content:"";
  position:absolute;
  inset:-40px;
  pointer-events:none;
  background:
    radial-gradient(700px circle at 15% 35%, rgba(56,189,248,0.18), transparent 60%),
    radial-gradient(700px circle at 85% 20%, rgba(99,102,241,0.18), transparent 62%),
    radial-gradient(900px circle at 50% 120%, rgba(34,211,238,0.10), transparent 60%);
  filter: blur(10px);
  opacity: 0.9;
}

/* Make sure header children render above the glow layer */
.topbar > *{position:relative;}

/* Brand balance */
.brandTitle{
  font-weight: 750;
  letter-spacing: -0.03em;
  color: rgba(255,255,255,0.92);
}
.brandSub{
  color: rgba(203,213,225,0.72);
  opacity: 1;
}

/* Logo card: calmer + cleaner */
.logo{
  background: linear-gradient(135deg, rgba(255,255,255,0.10), rgba(255,255,255,0.02));
  border: 1px solid rgba(255,255,255,0.14);
  box-shadow: 0 16px 38px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.10);
}

/* Top action buttons: unified glass look */
.topbar .btn{
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.08);
  color: rgba(255,255,255,0.92);
  box-shadow: 0 14px 34px rgba(0,0,0,0.32);
}

.topbar .btn:hover{
  transform: translateY(-1px);
  background: rgba(255,255,255,0.12);
  border-color: rgba(255,255,255,0.20);
  box-shadow: 0 18px 44px rgba(0,0,0,0.40);
}

.topbar .btn:active{
  transform: translateY(0px) scale(0.98);
}

/* Language pill a bit more premium */
.topbar .langPill{
  background: rgba(255,255,255,0.10);
  border-color: rgba(255,255,255,0.18);
}

/* Light mode keeps the same geometry, softer colors */
@media (prefers-color-scheme: light){
  .topbar{
    background: linear-gradient(180deg, rgba(255,255,255,0.72), rgba(255,255,255,0.46));
    border: 1px solid rgba(15,23,42,0.08);
    box-shadow: 0 18px 45px rgba(2,6,23,0.12), inset 0 1px 0 rgba(255,255,255,0.35);
  }
  .topbar::before{opacity:0.55;}
  .brandTitle{color: rgba(15,23,42,0.92);}
  .brandSub{color: rgba(30,41,59,0.68);}
  .topbar .btn{
    background: rgba(255,255,255,0.70);
    border: 1px solid rgba(15,23,42,0.10);
    color: rgba(15,23,42,0.92);
    box-shadow: 0 12px 26px rgba(2,6,23,0.10);
  }
  .topbar .btn:hover{background: rgba(255,255,255,0.85);}
}


/* ===== Build 3: Modern Add Habit Button Animation ===== */
.add-habit-btn{
  --c1:#38BDF8;
  --c2:#6366F1;
  --c3:#22D3EE;

  position:relative;
  padding:14px 22px;
  border-radius:999px;
  border:none;
  background:rgba(255,255,255,0.06);
  color:white;
  font-weight:650;
  letter-spacing:-0.01em;
  cursor:pointer;
  overflow:hidden;
  backdrop-filter:blur(12px);
  box-shadow:
    0 18px 40px rgba(0,0,0,.45),
    inset 0 1px 0 rgba(255,255,255,.18);
  transition:transform .35s ease, box-shadow .35s ease;
}

/* Gradient breathing glow */
.add-habit-btn::before{
  content:"";
  position:absolute;
  inset:-2px;
  border-radius:inherit;
  background:linear-gradient(135deg,var(--c1),var(--c2),var(--c3));
  opacity:.8;
  z-index:-1;
  filter:blur(8px);
  animation:habit-breath 5s ease-in-out infinite;
}

/* Shine sweep */
.add-habit-btn::after{
  content:"";
  position:absolute;
  top:-60%;
  left:-60%;
  width:220%;
  height:220%;
  background:linear-gradient(
    120deg,
    transparent 40%,
    rgba(255,255,255,.35),
    transparent 60%
  );
  transform:rotate(25deg);
  animation:habit-shine 4s infinite;
}

.add-habit-btn:hover{
  transform:translateY(-2px) scale(1.04);
  box-shadow:
    0 28px 60px rgba(99,102,241,.45),
    inset 0 1px 0 rgba(255,255,255,.25);
}

.add-habit-btn:active{
  transform:translateY(0) scale(.98);
}

@keyframes habit-breath{
  0%,100%{filter:blur(6px);opacity:.55}
  50%{filter:blur(14px);opacity:1}
}

@keyframes habit-shine{
  0%{transform:translateX(-100%) rotate(25deg)}
  60%{transform:translateX(100%) rotate(25deg)}
  100%{transform:translateX(100%) rotate(25deg)}
}


/* ===== Build 3: Modern animation for "+ Habit" button (balanced + premium) ===== */
.habitAddBtn.cometWebglBtn{
  /* premium glass surface */
  --c1:#38BDF8;
  --c2:#6366F1;
  --c3:#22D3EE;

  position:relative;
  isolation:isolate;
  border: 1px solid rgba(255,255,255,0.16) !important;
  background: rgba(255,255,255,0.08) !important;
  color:#fff !important;
  border-radius: 999px;
  overflow: visible; /* keep comet canvas visible outside the pill */
  box-shadow:
    0 18px 40px rgba(0,0,0,0.45),
    inset 0 1px 0 rgba(255,255,255,0.18);
  transition: transform .35s ease, box-shadow .35s ease, filter .35s ease, border-color .35s ease, background .35s ease;
  transform: translateZ(0);
}

/* Gradient glow ring (breathing) */
.habitAddBtn.cometWebglBtn::before{
  content:"";
  position:absolute;
  inset:-3px;
  border-radius:inherit;
  background: linear-gradient(135deg, var(--c1), var(--c2), var(--c3));
  opacity: .75;
  filter: blur(10px);
  z-index: 0;
  pointer-events:none;
  animation: habitBtnBreath 5.2s ease-in-out infinite;
}

/* Shine sweep */
.habitAddBtn.cometWebglBtn::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  background: linear-gradient(120deg,
    transparent 42%,
    rgba(255,255,255,0.38),
    transparent 58%);
  transform: translateX(-120%) rotate(20deg);
  z-index: 1;
  pointer-events:none;
  mix-blend-mode: screen;
  opacity: .55;
  animation: habitBtnShine 4.2s infinite;
}

/* Put comet canvas behind everything */
.habitAddBtn.cometWebglBtn .cometWebgl{
  z-index: -1 !important;
}

/* Ensure label stays on top */
.habitAddBtn.cometWebglBtn .cometBtnContent{
  z-index: 2 !important;
}

/* Hover/active micro-interactions */
.habitAddBtn.cometWebglBtn:hover{
  transform: translateY(-2px) scale(1.04);
  border-color: rgba(255,255,255,0.22) !important;
  background: rgba(255,255,255,0.10) !important;
  box-shadow:
    0 28px 60px rgba(99,102,241,0.45),
    0 10px 22px rgba(0,0,0,0.35),
    inset 0 1px 0 rgba(255,255,255,0.24);
  filter: saturate(1.05) brightness(1.04);
}

.habitAddBtn.cometWebglBtn:active{
  transform: translateY(0px) scale(0.985);
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  .habitAddBtn.cometWebglBtn::before,
  .habitAddBtn.cometWebglBtn::after{
    animation: none !important;
  }
  .habitAddBtn.cometWebglBtn{
    transition: none !important;
  }
}

@keyframes habitBtnBreath{
  0%,100%{ filter: blur(8px); opacity: .55; }
  50%{ filter: blur(14px); opacity: .95; }
}

@keyframes habitBtnShine{
  0%{ transform: translateX(-130%) rotate(20deg); opacity: 0; }
  12%{ opacity: .55; }
  58%{ transform: translateX(130%) rotate(20deg); opacity: .55; }
  70%,100%{ transform: translateX(130%) rotate(20deg); opacity: 0; }
}


/* ===== Build 3.1: synced button + header aurora ===== */
.add-habit-btn{
  --c1:#56CCF2;
  --c2:#5B6CFF;
  --c3:#6EE7F9;
}

.add-habit-btn::before{
  opacity:.75;
}

.topbar::before{
  opacity:0.95;
}


/* ===== Build 3.1: Modern premium animation for "+ Навик" (keeps comet WebGL) ===== */
.habitAddBtn.cometWebglBtn{
  --c1:#38BDF8;
  --c2:#6366F1;
  --c3:#22D3EE;

  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  box-shadow:
    0 18px 40px rgba(0,0,0,.45),
    inset 0 1px 0 rgba(255,255,255,.18);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);

  transform: translateZ(0); /* smoother animation */
}

/* Glow ring (breathing) */
.habitAddBtn.cometWebglBtn::before{
  content:"";
  position:absolute;
  inset:-2px;
  border-radius:999px;
  background: linear-gradient(135deg, var(--c1), var(--c2), var(--c3));
  opacity:.70;
  filter: blur(10px);
  z-index:0;
  pointer-events:none;
  animation: habitBtnBreath 5s ease-in-out infinite;
}

/* Shine sweep */
.habitAddBtn.cometWebglBtn::after{
  content:"";
  position:absolute;
  top:-70%;
  left:-70%;
  width:240%;
  height:240%;
  background: linear-gradient(120deg,
    transparent 42%,
    rgba(255,255,255,.34),
    transparent 62%);
  transform: rotate(25deg);
  z-index:2;
  pointer-events:none;
  animation: habitBtnShine 4.2s infinite;
  opacity:.9;
  mix-blend-mode: overlay;
}

/* Layering: canvas between glow and shine */
.habitAddBtn.cometWebglBtn .cometWebgl{ z-index:1; }
.habitAddBtn.cometWebglBtn .cometBtnContent{ z-index:3; }

/* Hover / Active */
.habitAddBtn.cometWebglBtn:hover{
  transform: translateY(-2px) scale(1.04);
  box-shadow:
    0 28px 60px rgba(99,102,241,.45),
    0 10px 26px rgba(0,0,0,.35),
    inset 0 1px 0 rgba(255,255,255,.24);
  border-color: rgba(255,255,255,0.20);
}

.habitAddBtn.cometWebglBtn:active{
  transform: translateY(0) scale(.985);
}

/* Slightly cleaner text glow to match modern look */
.habitAddBtn.cometWebglBtn .cometBtnPlus{
  text-shadow: 0 0 14px rgba(255,210,140,0.45);
}
.habitAddBtn.cometWebglBtn .cometBtnText{
  text-shadow: 0 2px 10px rgba(0,0,0,0.32);
}

/* Reduced motion accessibility */
@media (prefers-reduced-motion: reduce){
  .habitAddBtn.cometWebglBtn::before,
  .habitAddBtn.cometWebglBtn::after{
    animation: none !important;
  }
  .habitAddBtn.cometWebglBtn{
    transition: none !important;
  }
}

@keyframes habitBtnBreath{
  0%,100%{ filter: blur(7px); opacity:.55; }
  50%{ filter: blur(14px); opacity:1; }
}

@keyframes habitBtnShine{
  0%{ transform: translateX(-110%) rotate(25deg); }
  60%{ transform: translateX(110%) rotate(25deg); }
  100%{ transform: translateX(110%) rotate(25deg); }
}


/* ===== Build 3.2: Transparent header, animations preserved ===== */
.topbar{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

/* Keep aurora / animation layers visible */
.topbar::before{
  opacity: 1;
}

/* Buttons stay animated */


/* ===== Build 3.3: Header fully blends with page background ===== */
.topbar{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

/* Remove ALL blue / aurora / light effects */
.topbar::before,
.topbar::after{
  content:none !important;
  display:none !important;
}

/* Calm text colors matching global background */
.brandTitle{
  color: rgba(255,255,255,0.92);
}

.brandSub{
  color: rgba(203,213,225,0.70);
}

/* Buttons keep shape but no blue glow */
.topbar .btn,
.add-habit-btn{
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: none;
}

/* Hover stays subtle */
.topbar .btn:hover,
.add-habit-btn:hover{
  background: rgba(255,255,255,0.10);
}

/* Kill any leftover gradients */
.topbar *{
  background-image: none !important;
}


/* ===== Build 3.4: Force-remove ALL header background layers ===== */
.topbar{
  background: none !important;
  background-image: none !important;
  border: none !important;
  box-shadow: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

/* Kill any child backgrounds / gradients */
.topbar *,
.topbar *::before,
.topbar *::after{
  background: none !important;
  background-image: none !important;
  filter: none !important;
}

/* Ensure header is purely content */
.topbar{
  pointer-events: auto;
}


/* ===== Build 3.5: Remove annoying blue streak (cometWeek) but keep button animations ===== */
.cometFx.cometWeek{
  display:none !important;
  opacity:0 !important;
}

/* Safety: if any cometFx is used elsewhere, keep it subtle */
.cometFx{
  mix-blend-mode: normal !important;
  filter: none !important;
}


/* ===== Build 3.6: Remove remaining blue container box ===== */

/* Remove section/container background under header */
.section,
.sectionHeader,
.headerWrap,
.hero,
.weekHeader{
  background: transparent !important;
  background-image: none !important;
  border: none !important;
  box-shadow: none !important;
}

/* If header sits inside a card */
.card,
.panel,
.box{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

/* Ensure nothing tints the top area */
.section *{
  backdrop-filter: none !important;
}


/* ===== Build 3.7: Remove ALL card/box surfaces (full blend into background) ===== */
.card{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

/* Habits header row shouldn't paint a bar */
.habitHeadRow{
  background: transparent !important;
  border-bottom: 1px solid rgba(255,255,255,0.10) !important;
}

/* Pills / rows: remove any panel tint */
.habitSectionFix,
.habitWrap{
  background: transparent !important;
}

/* If any generic surface classes exist */
.surface, .panel, .sheet, .box, .glass{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}


/* ===== Build 3.8: Restore subtle glass cards (match reference) ===== */
.card{
  background: linear-gradient(180deg, rgba(20,30,60,0.55), rgba(10,15,35,0.45)) !important;
  border: 1px solid rgba(255,255,255,0.08) !important;
  box-shadow: 0 10px 30px rgba(0,0,0,0.35) !important;
  backdrop-filter: blur(8px);
}

.habitHeadRow{
  background: linear-gradient(180deg, rgba(20,30,60,0.55), rgba(10,15,35,0.45)) !important;
  border-bottom: 1px solid rgba(255,255,255,0.10) !important;
}


/* ===== Build 3.9: Remove blue box behind Habit/Week controls ONLY ===== */

/* Target the home header card */
.card.section,
.card.section.featured,
.card.section.finHero{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

/* Week selector container */
.weekComfy,
.weekComfyPill{
  background: rgba(255,255,255,0.06);
}

/* Keep other cards intact */


/* v10.2.4: remove blue header wash behind Week/+Habit (was painted via cardHead pseudo layer) */
.habitSectionFix .cardHead{
  background: transparent !important;
}
.habitSectionFix .cardHead::before{
  display:none !important;
  content:none !important;
}


/* v10.2.5: fix right-side cut-off buttons (remove clipping container) */
.topbar,
.cardHead,
.habitSectionFix{
  overflow: visible !important;
}

/* ensure buttons are not masked */
.topbar .btn,
.add-habit-btn,
.weekPill{
  overflow: visible !important;
}

/* v10.2.6: phone-safe KPIs + remove 0/7 counters */
@media (max-width:520px){
  .kpi{min-width:0 !important;}
  .habitStats{grid-template-columns:1fr 1fr !important;}
  .app{padding-bottom:140px !important;}
}


/* ===== v10.2.7: Home screen modern refresh + desktop spacing ===== */

/* More breathing room so bottom nav never overlaps content */
.app{
  padding-bottom: calc(140px + env(safe-area-inset-bottom)) !important;
}

/* Centering and nicer max width on wide screens */
@media (min-width: 1100px){
  .app{ max-width: 1100px; }
}

/* Unified modern glass surfaces (dashboard + weekly overview) */
:root[data-sky="night"] .card{
  background: rgba(15,23,42,0.22) !important;
  border: 1px solid rgba(255,255,255,0.10) !important;
  box-shadow: 0 18px 55px rgba(0,0,0,0.35) !important;
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}
:root[data-sky="night"] .section{
  padding: 18px !important;
  margin: 14px 0 !important;
}

/* Softer, more premium dashboard cards */
:root[data-sky="night"] .donutCard,
:root[data-sky="night"] .weekTile{
  background: rgba(255,255,255,0.06) !important;
  border: 1px solid rgba(255,255,255,0.10) !important;
  box-shadow: 0 14px 40px rgba(0,0,0,0.32) !important;
}

/* Remove harsh light look in any mode */
.donutCard, .weekTile{
  border-radius: 22px !important;
}

/* Improve headline spacing on home */
.section .h1{
  font-size: 19px !important;
  letter-spacing: -0.02em;
}
.section .sub{
  opacity: 0.78;
}

/* Bottom nav: slightly more opaque on desktop to avoid visual "collision" */
@media (min-width: 900px){
  .bottomnav.neonNav{
    background:
      radial-gradient(120% 180% at 18% 0%, rgba(255,77,255,.18) 0%, rgba(0,0,0,0) 58%),
      radial-gradient(120% 180% at 92% 12%, rgba(96,165,250,.12) 0%, rgba(0,0,0,0) 62%),
      linear-gradient(180deg, rgba(126,34,206,.70) 0%, rgba(76,29,149,.78) 42%, rgba(24,9,64,.92) 100%);
  }
}


/* v10.2.8: Make dashboard match cosmic background (glass in both themes) */
:root[data-sky="day"] .card{
  background: rgba(255,255,255,0.08) !important;
  border: 1px solid rgba(255,255,255,0.14) !important;
  box-shadow: 0 18px 55px rgba(0,0,0,0.32) !important;
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}
:root[data-sky="day"] .donutCard,
:root[data-sky="day"] .weekTile{
  background: rgba(255,255,255,0.08) !important;
  border: 1px solid rgba(255,255,255,0.14) !important;
  box-shadow: 0 14px 40px rgba(0,0,0,0.28) !important;
}

/* Ensure content never collides with bottom nav on desktop either */
.app{
  padding-bottom: calc(160px + env(safe-area-inset-bottom)) !important;
}


/* v10.3.0 — Dashboard refinement (cleaner, lighter, modern) */

/* Dashboard container */
.dashboard{
  background: transparent !important;
  padding: 24px 0 8px;
}

/* Head message */
.dashboardNotice{
  background: linear-gradient(
    135deg,
    rgba(255,255,255,0.10),
    rgba(255,255,255,0.03)
  );
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.12);
}

/* KPI cards */
.kpiCard{
  background: linear-gradient(
    180deg,
    rgba(255,255,255,0.10),
    rgba(255,255,255,0.04)
  );
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow:
    0 10px 30px rgba(0,0,0,0.35),
    inset 0 1px 0 rgba(255,255,255,0.12);
  transition: transform .35s ease, box-shadow .35s ease;
}
.kpiCard:hover{
  transform: translateY(-4px);
  box-shadow:
    0 18px 45px rgba(0,0,0,0.45),
    inset 0 1px 0 rgba(255,255,255,0.18);
}

/* Weekly overview cards */
.weekCard{
  background: linear-gradient(
    180deg,
    rgba(255,255,255,0.08),
    rgba(255,255,255,0.03)
  );
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 8px 24px rgba(0,0,0,0.30);
}

/* Bottom nav separation */
.bottomNav{
  backdrop-filter: blur(18px);
  background: linear-gradient(
    180deg,
    rgba(88,34,165,0.55),
    rgba(32,14,72,0.75)
  );
}


/* ===== v10.3.0 Dashboard refresh (modern glass, better layout) ===== */

/* Global card surface: lighter, more premium in night */
:root[data-sky="night"] .card{
  background: rgba(10, 14, 28, 0.55);
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow:
    0 18px 55px rgba(0,0,0,0.42),
    inset 0 1px 0 rgba(255,255,255,0.08);
}

/* Featured sections get a subtle gradient and stronger blur without looking like a box */
:root[data-sky="night"] .card.section.featured{
  background:
    radial-gradient(900px circle at 15% 0%, rgba(99,102,241,0.10), transparent 60%),
    radial-gradient(900px circle at 85% 100%, rgba(56,189,248,0.08), transparent 60%),
    rgba(10, 14, 28, 0.52);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
}

/* Make the dashboard sections feel less “framed” on big screens */
.card.section{ border-radius: 22px; }
.section{ padding:18px; margin:14px 0; }

/* Donut cards: calmer, cleaner, better hover */
.donutCard{
  background: rgba(255,255,255,0.045) !important;
  border: 1px solid rgba(255,255,255,0.10) !important;
  box-shadow: 0 16px 42px rgba(0,0,0,0.34) !important;
  border-radius: 22px !important;
}
.donutCard:hover{
  transform: translateY(-2px);
  box-shadow: 0 22px 58px rgba(0,0,0,0.44) !important;
}
.donutMeta{
  color: rgba(203,213,225,0.72) !important;
  font-weight: 800;
}

/* Weekly tiles: use 3 columns on desktop (no empty gap), softer surface */
@media (min-width:900px){
  .weekTiles{ grid-template-columns: repeat(3, 1fr) !important; }
}
.weekTile{
  background: rgba(255,255,255,0.045) !important;
  border: 1px solid rgba(255,255,255,0.10) !important;
  box-shadow: 0 14px 36px rgba(0,0,0,0.30) !important;
  border-radius: 20px !important;
}
.weekTile:hover{
  transform: translateY(-2px);
  box-shadow: 0 20px 52px rgba(0,0,0,0.40) !important;
}

/* Insight bar: more “pill” and less boxy */
.insightRow{
  background: rgba(255,255,255,0.035) !important;
  border: 1px solid rgba(255,255,255,0.08) !important;
  border-radius: 16px !important;
}

/* Keep things safe on small screens */
@media (max-width:420px){
  .section{ padding:14px; }
  .donutRow{ gap:12px; }
}
/* ===== end v10.3.0 ===== */


/* ===== v10.3.1 Donut KPI redesign (thin, calm, modern) ===== */
.donutRing{
  stroke-width: 6 !important;
  opacity: 0.85;
}
.donutTrack{
  stroke-width: 6 !important;
  opacity: 0.25;
}
.donutValue{
  font-size: 28px !important;
  font-weight: 800 !important;
  letter-spacing: -0.02em;
}
.donutLabel{
  font-size: 12px !important;
  opacity: 0.7;
}

/* Reduce plastic feel */
.donutCard{
  background: rgba(255,255,255,0.035) !important;
  box-shadow:
    0 12px 32px rgba(0,0,0,0.32),
    inset 0 1px 0 rgba(255,255,255,0.06) !important;
}

/* Hover micro interaction */
.donutCard:hover .donutRing{
  opacity: 1;
}

/* Mobile calm */
@media (max-width:420px){
  .donutValue{ font-size: 24px !important; }
}
/* ===== end v10.3.1 ===== */


/* ===== v10.3.1 Donut visuals polish ===== */
.donut svg{ width: 210px; height: 210px; }
@media (max-width:420px){
  .donut svg{ width: 190px; height: 190px; }
}


/* ===== v10.3.2 Micro-interactions ===== */

/* Generic hover lift */
.card:hover, .weekTile:hover, .donutCard:hover{
  transform: translateY(-3px) scale(1.01);
  transition: transform .25s ease, box-shadow .25s ease;
}

/* Active tap feedback */
.card:active, .weekTile:active, .donutCard:active{
  transform: translateY(0) scale(0.98);
}

/* Habit check micro pop */
.habitDot{
  transition: transform .18s ease, background-color .18s ease;
}
.habitDot.checked{
  transform: scale(1.12);
}

/* Button spring */
.btn, .add-habit-btn{
  transition: transform .2s cubic-bezier(.2,.8,.2,1), box-shadow .2s ease;
}
.btn:hover, .add-habit-btn:hover{
  transform: translateY(-1px);
}
.btn:active, .add-habit-btn:active{
  transform: translateY(0) scale(0.96);
}

/* Reduce motion respect */
@media (prefers-reduced-motion: reduce){
  *{transition:none !important; animation:none !important;}
}
/* ===== end v10.3.2 ===== */


/* ===== v10.4.0 Habit UX upgrade ===== */

/* Today column highlight */
.habitGrid .day.today{
  box-shadow: inset 0 0 0 2px rgba(99,102,241,.55);
}

/* Checked state feedback */
.habitBox.on{
  background: color-mix(in srgb, var(--hc) 18%, rgba(255,255,255,.04));
}
.habitBox.on::after{
  content:"✓";
  position:absolute;
  inset:0;
  display:grid;
  place-items:center;
  color:white;
  font-weight:800;
}

/* Streak subtle glow */
.habitRow[data-streak="true"]{
  box-shadow: 0 0 0 1px rgba(34,197,94,.35), 0 10px 30px rgba(34,197,94,.18);
}

/* Long press hint */
.habitRow .hint{
  font-size:12px;
  opacity:.55;
}


/* ===== v10.4.1 Habit notes modal + undo ===== */
.noteModal{
  position:fixed; inset:0; z-index:1000;
  display:none; place-items:center;
  background: rgba(2,6,23,.55);
  backdrop-filter: blur(8px);
}
.noteModal.open{ display:grid; }
.noteCard{
  width:min(92vw,420px);
  background: rgba(15,23,42,.75);
  border:1px solid rgba(255,255,255,.14);
  border-radius:18px;
  padding:16px;
  box-shadow:0 24px 60px rgba(0,0,0,.45);
}
.noteCard h3{ margin:0 0 8px; }
.noteCard textarea{
  width:100%; min-height:110px;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.14);
  border-radius:12px;
  color:white; padding:10px;
}
.noteActions{
  display:flex; justify-content:flex-end; gap:10px; margin-top:10px;
}
.undoToast{
  position:fixed; bottom:90px; left:50%; transform:translateX(-50%);
  background: rgba(15,23,42,.85);
  border:1px solid rgba(255,255,255,.14);
  border-radius:999px;
  padding:8px 14px;
  display:none; gap:10px; align-items:center;
}
.undoToast.show{ display:flex; }


/* ===== v10.4.1 Notes + Undo UI ===== */
.habitDay.today{
  color: rgba(255,255,255,0.95);
  text-shadow: 0 0 22px rgba(99,102,241,0.35);
}
.habitBox.today{
  box-shadow: inset 0 0 0 2px rgba(99,102,241,0.45);
}

.undoToast{
  position: fixed;
  left: 50%;
  bottom: 86px;
  transform: translateX(-50%) translateY(18px);
  display:flex;
  align-items:center;
  gap:12px;
  padding: 10px 12px;
  border-radius: 999px;
  background: rgba(10, 14, 28, 0.72);
  border: 1px solid rgba(255,255,255,0.14);
  box-shadow: 0 18px 55px rgba(0,0,0,0.42);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  opacity:0;
  pointer-events:none;
  transition: opacity 180ms var(--mi-ease, ease), transform 220ms var(--mi-ease, ease);
  z-index: 9999;
}
.undoToast.show{
  opacity:1;
  transform: translateX(-50%) translateY(0px);
  pointer-events:auto;
}
.undoToast .undoMsg{ font-weight: 650; opacity:.92; }

.noteModal .noteText{
  width:100%;
  min-height: 120px;
  resize: vertical;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.92);
  padding: 10px 12px;
  outline: none;
}
.noteActions{
  display:flex;
  justify-content:flex-end;
  gap:10px;
  margin-top: 12px;
}
/* ===== end v10.4.1 ===== */


/* ===== v10.4.2 Notes indicator (subtle, non-intrusive) ===== */
.habitBox.hasNote::after{
  content:"";
  position:absolute;
  top:6px;
  right:6px;
  width:6px;
  height:6px;
  border-radius:50%;
  background: rgba(99,102,241,.9);
  box-shadow: 0 0 0 2px rgba(2,6,23,.6);
}
